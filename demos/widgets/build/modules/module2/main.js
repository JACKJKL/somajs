/**
 * @license RequireJS text 2.0.7 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/** @license
 * RequireJS Image Plugin
 * Author: Miller Medeiros
 * Version: 0.2.2 (2013/02/08)
 * Released under the MIT license
 */

(function(global){var Module2=function(target,modelText,image,externalImage){console.log("[module2] created",target,modelText,image,externalImage),target.appendChild(image.cloneNode(!0));var template=soma.template.create(target),scope=template.scope;scope.img=externalImage,template.render()};global.widgets=global.widgets||{},global.widgets.Module2=Module2})(this),define("modules/module2/main",function(global){return function(){var ret,fn;return ret||global.widgets.Module2}}(this)),function(global){var Model2=function(){this.data={text:"I'm the module 2"}};global.widgets=global.widgets||{},global.widgets.Model2=Model2}(this),define("modules/module2/model",function(global){return function(){var ret,fn;return ret||global.widgets.Model2}}(this)),define("text",["module"],function(module){var text,fs,Cc,Ci,progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!="undefined"&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap={},masterConfig=module.config&&module.config()||{};text={version:"2.0.7",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var modName,ext,temp,strip=!1,index=name.indexOf("."),isRelative=name.indexOf("./")===0||name.indexOf("../")===0;return index!==-1&&(!isRelative||index>1)?(modName=name.substring(0,index),ext=name.substring(index+1,name.length)):modName=name,temp=ext||modName,index=temp.indexOf("!"),index!==-1&&(strip=temp.substring(index+1)==="strip",temp=temp.substring(0,index),ext?ext=temp:modName=temp),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);return match?(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&(!uPort&&!uHostName||uPort===port)):!0},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config.isBuild&&!config.inlineText){onLoad();return}masterConfig.isBuild=config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+(parsed.ext?"."+parsed.ext:""),url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)})},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),extPart=parsed.ext?"."+parsed.ext:"",nonStripName=parsed.moduleName+extPart,fileName=req.toUrl(parsed.moduleName+extPart)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}};if(masterConfig.env==="node"||!masterConfig.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)fs=require.nodeRequire("fs"),text.get=function(url,callback,errback){try{var file=fs.readFileSync(url,"utf8");file.indexOf("ï»¿")===0&&(file=file.substring(1)),callback(file)}catch(e){errback(e)}};else if(masterConfig.env==="xhr"||!masterConfig.env&&text.createXhr())text.get=function(url,callback,errback,headers){var xhr=text.createXhr(),header;xhr.open("GET",url,!0);if(headers)for(header in headers)headers.hasOwnProperty(header)&&xhr.setRequestHeader(header.toLowerCase(),headers[header]);masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;xhr.readyState===4&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):callback(xhr.responseText),masterConfig.onXhrComplete&&masterConfig.onXhrComplete(xhr,url))},xhr.send(null)};else if(masterConfig.env==="rhino"||!masterConfig.env&&typeof Packages!="undefined"&&typeof java!="undefined")text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content="";try{stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&line.charAt(0)===65279&&(line=line.substring(1)),line!==null&&stringBuffer.append(line);while((line=input.readLine())!==null)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)};else if(masterConfig.env==="xpconnect"||!masterConfig.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)Cc=Components.classes,Ci=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),text.get=function(url,callback){var inStream,convertStream,readData={},fileObj=new FileUtils.File(url);try{inStream=Cc["@mozilla.org/network/file-input-stream;1"].createInstance(Ci.nsIFileInputStream),inStream.init(fileObj,1,0,!1),convertStream=Cc["@mozilla.org/intl/converter-input-stream;1"].createInstance(Ci.nsIConverterInputStream),convertStream.init(inStream,"utf-8",inStream.available(),Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),convertStream.readString(inStream.available(),readData),convertStream.close(),inStream.close(),callback(readData.value)}catch(e){throw new Error((fileObj&&fileObj.path||"")+": "+e)}};return text}),define("text!modules/module2/module.html",[],function(){return'<div class="module2">\n	<h3>Module 2</h3>\n	<img data-src="{{img}}"/>\n</div>\n'}),define("image",[],function(){function noop(){}function cacheBust(url){return url=url.replace(CACHE_BUST_FLAG,""),url+=url.indexOf("?")<0?"?":"&",url+CACHE_BUST_QUERY_PARAM+"="+Math.round(2147483647*Math.random())}var CACHE_BUST_QUERY_PARAM="bust",CACHE_BUST_FLAG="!bust",RELATIVE_FLAG="!rel";return{load:function(name,req,onLoad,config){var img;config.isBuild?onLoad(null):(img=new Image,img.onerror=function(err){onLoad.error(err)},img.onload=function(evt){onLoad(img);try{delete img.onload}catch(err){img.onload=noop}},name.indexOf(RELATIVE_FLAG)!==-1?img.src=req.toUrl(name.replace(RELATIVE_FLAG,"")):img.src=name)},normalize:function(name,normalize){return name.indexOf(CACHE_BUST_FLAG)===-1?name:cacheBust(name)}}}),define("js/libs/normalize",["require","module"],function(require,module){function convertURIBase(uri,fromBase,toBase){if(uri.indexOf("data:")===0)return uri;uri=removeDoubleSlashes(uri);if(uri.match(/^\//)||uri.match(protocolRegEx))return uri;var toBaseProtocol=toBase.match(protocolRegEx),fromBaseProtocol=fromBase.match(protocolRegEx);return fromBaseProtocol&&(!toBaseProtocol||toBaseProtocol[1]!=fromBaseProtocol[1]||toBaseProtocol[2]!=fromBaseProtocol[2])?absoluteURI(uri,fromBase):relativeURI(absoluteURI(uri,fromBase),toBase)}function absoluteURI(uri,base){uri.substr(0,2)=="./"&&(uri=uri.substr(2));var baseParts=base.split("/"),uriParts=uri.split("/");baseParts.pop();while(curPart=uriParts.shift())curPart==".."?baseParts.pop():baseParts.push(curPart);return baseParts.join("/")}function relativeURI(uri,base){var baseParts=base.split("/");baseParts.pop(),base=baseParts.join("/")+"/",i=0;while(base.substr(i,1)==uri.substr(i,1))i++;while(base.substr(i,1)!="/")i--;base=base.substr(i+1),uri=uri.substr(i+1),baseParts=base.split("/");var uriParts=uri.split("/");out="";while(baseParts.shift())out+="../";while(curPart=uriParts.shift())out+=curPart+"/";return out.substr(0,out.length-1)}var slashes=/([^:])\/+/g,removeDoubleSlashes=function(uri){return uri.replace(slashes,"$1/")},protocolRegEx=/[^\:\/]*:\/\/([^\/])*/,normalizeCSS=function(source,fromBase,toBase,cssBase){fromBase=removeDoubleSlashes(fromBase),toBase=removeDoubleSlashes(toBase);var urlRegEx=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/ig,result,url,source;while(result=urlRegEx.exec(source)){url=result[3]||result[2]||result[5]||result[6]||result[4];var newUrl;cssBase&&url.substr(0,1)=="/"?newUrl=cssBase+url:newUrl=convertURIBase(url,fromBase,toBase);var quoteLen=result[5]||result[6]?1:0;source=source.substr(0,urlRegEx.lastIndex-url.length-quoteLen-1)+newUrl+source.substr(urlRegEx.lastIndex-quoteLen-1),urlRegEx.lastIndex=urlRegEx.lastIndex+(newUrl.length-url.length)}return source};return normalizeCSS.convertURIBase=convertURIBase,normalizeCSS}),define("js/libs/require-css",["./normalize"],function(normalize){function indexOf(a,e){for(var i=0,l=a.length;i<l;i++)if(a[i]===e)return i;return-1}if(typeof window=="undefined")return{load:function(n,r,load){load()}};var testing=!1,head=document.getElementsByTagName("head")[0],engine=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/),hackLinks=!1;!engine||(engine[1]||engine[7]?(hackLinks=parseInt(engine[1])<6||parseInt(engine[7])<=9,engine="trident"):engine[2]?(hackLinks=!0,engine="webkit"):engine[3]||(engine[4]?(hackLinks=parseInt(engine[4])<18,engine="gecko"):testing&&alert("Engine detection failed")));var cssAPI={},absUrlRegEx=/^\/|([^\:\/]*:)/;cssAPI.pluginBuilder="./css-builder";var curBuffer=[],onBufferLoad={},bufferResources=[];cssAPI.addBuffer=function(resourceId){if(indexOf(curBuffer,resourceId)!=-1)return;if(indexOf(bufferResources,resourceId)!=-1)return;curBuffer.push(resourceId),bufferResources.push(resourceId)},cssAPI.setBuffer=function(css,isLess){var pathname=window.location.pathname.split("/");pathname.pop(),pathname=pathname.join("/")+"/";var baseParts=require.toUrl("base_url").split("/");baseParts.pop();var baseUrl=baseParts.join("/")+"/";baseUrl=normalize.convertURIBase(baseUrl,pathname,"/"),baseUrl.match(absUrlRegEx)||(baseUrl="/"+baseUrl),baseUrl.substr(baseUrl.length-1,1)!="/"&&(baseUrl+="/"),cssAPI.inject(normalize(css,baseUrl,pathname));for(var i=0;i<curBuffer.length;i++)(isLess&&curBuffer[i].substr(curBuffer[i].length-5,5)==".less"||!isLess&&curBuffer[i].substr(curBuffer[i].length-4,4)==".css")&&(function(resourceId){onBufferLoad[resourceId]=onBufferLoad[resourceId]||!0,setTimeout(function(){typeof onBufferLoad[resourceId]=="function"&&onBufferLoad[resourceId](),delete onBufferLoad[resourceId]},7)}(curBuffer[i]),curBuffer.splice(i--,1))},cssAPI.attachBuffer=function(resourceId,load){for(var i=0;i<curBuffer.length;i++)if(curBuffer[i]==resourceId)return onBufferLoad[resourceId]=load,!0;if(onBufferLoad[resourceId]===!0)return onBufferLoad[resourceId]=load,!0;if(indexOf(bufferResources,resourceId)!=-1)return load(),!0};var webkitLoadCheck=function(link,callback){setTimeout(function(){for(var i=0;i<document.styleSheets.length;i++){var sheet=document.styleSheets[i];if(sheet.href==link.href)return callback()}webkitLoadCheck(link,callback)},10)},mozillaLoadCheck=function(style,callback){setTimeout(function(){try{return style.sheet.cssRules,callback()}catch(e){}mozillaLoadCheck(style,callback)},10)};if(engine=="trident"&&hackLinks)var ieStyles=[],ieQueue=[],ieStyleCnt=0,ieLoad=function(url,callback){var style;ieQueue.push({url:url,cb:callback}),style=ieStyles.shift(),!style&&ieStyleCnt++<12&&(style=document.createElement("style"),head.appendChild(style)),ieLoadNextImport(style)},ieLoadNextImport=function(style){var curImport=ieQueue.shift();if(!curImport){style.onload=noop,ieStyles.push(style);return}style.onload=function(){curImport.cb(curImport.ss),ieLoadNextImport(style)};var curSheet=style.styleSheet;curImport.ss=curSheet.imports[curSheet.addImport(curImport.url)]};var createLink=function(url){var link=document.createElement("link");return link.type="text/css",link.rel="stylesheet",link.href=url,link},noop=function(){};cssAPI.linkLoad=function(url,callback){var timeout=setTimeout(function(){testing&&alert("timeout"),callback()},waitSeconds*1e3-100),_callback=function(){clearTimeout(timeout),link&&(link.onload=noop),setTimeout(callback,7)};if(!hackLinks){var link=createLink(url);link.onload=_callback,head.appendChild(link)}else if(engine=="webkit"){var link=createLink(url);webkitLoadCheck(link,_callback),head.appendChild(link)}else if(engine=="gecko"){var style=document.createElement("style");style.textContent='@import "'+url+'"',mozillaLoadCheck(style,_callback),head.appendChild(style)}else engine=="trident"&&ieLoad(url,_callback)};var progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],fileCache={},get=function(url,callback,errback){if(fileCache[url]){callback(fileCache[url]);return}var xhr,i,progId;if(typeof XMLHttpRequest!="undefined")xhr=new XMLHttpRequest;else if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}xhr.open("GET",url,requirejs.inlineRequire?!1:!0),xhr.onreadystatechange=function(evt){var status,err;xhr.readyState===4&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):(fileCache[url]=xhr.responseText,callback(xhr.responseText)))},xhr.send(null)},styleCnt=0,curStyle;cssAPI.inject=function(css){styleCnt<31&&(curStyle=document.createElement("style"),curStyle.type="text/css",head.appendChild(curStyle),styleCnt++),curStyle.styleSheet?curStyle.styleSheet.cssText+=css:curStyle.appendChild(document.createTextNode(css))};var importRegEx=/@import\s*(url)?\s*(('([^']*)'|"([^"]*)")|\(('([^']*)'|"([^"]*)"|([^\)]*))\))\s*;?/g,pathname=window.location.pathname.split("/");pathname.pop(),pathname=pathname.join("/")+"/";var loadCSS=function(fileUrl,callback,errback){fileUrl.match(absUrlRegEx)||(fileUrl="/"+normalize.convertURIBase(fileUrl,pathname,"/")),get(fileUrl,function(css){css=normalize(css,fileUrl,pathname);var importUrls=[],importIndex=[],importLength=[],match;while(match=importRegEx.exec(css)){var importUrl=match[4]||match[5]||match[7]||match[8]||match[9];importUrls.push(importUrl),importIndex.push(importRegEx.lastIndex-match[0].length),importLength.push(match[0].length)}var completeCnt=0;for(var i=0;i<importUrls.length;i++)(function(i){loadCSS(importUrls[i],function(importCSS){css=css.substr(0,importIndex[i])+importCSS+css.substr(importIndex[i]+importLength[i]);var lenDiff=importCSS.length-importLength[i];for(var j=i+1;j<importUrls.length;j++)importIndex[j]+=lenDiff;completeCnt++,completeCnt==importUrls.length&&callback(css)},errback)})(i);importUrls.length==0&&callback(css)},errback)};cssAPI.normalize=function(name,normalize){return name.substr(name.length-4,4)==".css"&&(name=name.substr(0,name.length-4)),normalize(name)};var waitSeconds,alerted=!1;return cssAPI.load=function(cssId,req,load,config,parse){waitSeconds=waitSeconds||config.waitSeconds||7;var resourceId=cssId+(parse?".less":".css");if(cssAPI.attachBuffer(resourceId,load))return;fileUrl=req.toUrl(resourceId),!alerted&&testing&&(alert(hackLinks?"hacking links":"not hacking"),alerted=!0),parse?loadCSS(fileUrl,function(css){parse&&(css=parse(css,function(css){cssAPI.inject(css),setTimeout(load,7)}))}):cssAPI.linkLoad(fileUrl,load)},testing&&(cssAPI.inspect=function(){if(stylesheet.styleSheet)return stylesheet.styleSheet.cssText;if(stylesheet.innerHTML)return stylesheet.innerHTML}),cssAPI}),requirejs.s.contexts._.nextTick=function(f){f()},require(["css"],function(css){css.addBuffer("modules/module2/styles.css")}),requirejs.s.contexts._.nextTick=requirejs.nextTick,requirejs.s.contexts._.nextTick=function(f){f()},require(["css"],function(css){css.setBuffer(".module2 h3 {\n	color: blue;\n}")}),requirejs.s.contexts._.nextTick=requirejs.nextTick;