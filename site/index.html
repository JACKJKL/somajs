<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<title>soma-template by soundstep</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
	<link rel="icon" type="image/png" href="favicon.png">
	<link rel="stylesheet" href="assets/gh-buttons/gh-buttons.css">
	<link rel="stylesheet" href="assets/styles/pygment/native.css">
	<link rel="stylesheet" href="assets/styles/styles.css">
	<script src="assets/js/libs/respond.js"></script>
	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<link rel="shortcut icon" href="../assets/common/images/favicon.ico">
	<link rel="apple-touch-icon" href="../assets/common/images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="../assets/common/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="../assets/common/images/apple-touch-icon-114x114.png">

	<script type="text/javascript">

		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-36294101-3']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();

	</script>

</head>
<body>

<div class="wrapper">
	<header>
		<h1><a href="./">soma.js</a></h1>

		<p>Scalable javascript framework</p>

		<ul>
			<li><a href="https://github.com/somajs/somajs/zipball/master">Download <strong>ZIP File</strong></a></li>
			<li><a href="https://github.com/somajs/somajs/tarball/master">Download <strong>TAR Ball</strong></a></li>
			<li><a href="https://github.com/somajs/somajs">View On <strong>GitHub</strong></a></li>
		</ul>

	</header>

	<div id="navigation">
		<nav>
			<ul>
				<li><a href="#what-is-soma-js">What is soma.js?</a></li>
				<li><a href="#download">Download</a></li>
				<li><a href="#quick-start">Quick start</a></li>
				<li><a href="#application-instance">Application instance</a></li>
				<li><a href="#core-elements">Core elements</a></li>
				<li>
					<p><a href="#dependency-injection">Dependency injection</a><p>
					<ul class="hidden">
						<li><a href="#what-is-dependency-injection">What is dependency injection?</a></li>
						<li><a href="#using-dependency-injection-in-somajs">Using dependency injection in soma.js</a></li>
						<li><a href="https://github.com/soundstep/infuse.js" target="_blank">infuse.js</a></li>
					</ul>
				</li>
				<li><p><a href="#communication">Communication</a></p>
					<ul class="hidden">
						<li><a href="#native-event-system">Native event system</a></li>
						<li><a href="#creating-and-dispatching-events">Creating and dispatching events</a></li>
						<li><a href="#listening-to-events">Listening to events</a></li>
						<li><a href="#send-parameters">Send parameters</a></li>
						<li><a href="https://github.com/soundstep/soma-events" target="_blank">soma-events</a></li>
					</ul>
				</li>
				<li><p><a href="#command">Command</a></p>
					<ul class="hidden">
						<li><a href="#create-commands">Create commands</a></li>
						<li><a href="#manage-commands">Manage commands</a></li>
						<li><a href="#simple-command-example">Simple command example</a></li>
						<li><a href="#flow-control">Flow control</a></li>
					</ul>
				</li>
				<li><p><a href="#mediator">Mediator</a></p>
					<ul class="hidden">
						<li><a href="#create-mediators">Create mediators</a></li>
						<li><a href="#simple-mediator-example">Simple mediator example</a></li>
						<li><a href="#decoupling-communication">Decoupling communication</a></li>
					</ul>
				</li>
				<li><p><a href="#template">Template</a></p>
					<ul class="hidden">
						<li><a href="#load-template-plugin">Load the template plugin</a></li>
						<li><a href="#create-a-template">Create a template</a></li>
						<li><a href="#simple-template-example">Simple template example</a></li>
					</ul>
				</li>
				<li><a href="#oop">OOP</a></li>
				<li><a href="#plugins">Plugins</a></li>
				<li><a href="#tools">Tools</a></li>
				<li><a href="#demos">Demos</a></li>
				<li><a href="#tests">Tests</a></li>
				<li><a href="#browser-support">Browser support</a></li>
		</nav>
		<footer>
			<p>
				<a href="https://twitter.com/soundstep" target="_blank">@soundstep</a><br/>
				<a href="http://www.soundstep.com" target="_blank">www.soundstep.com</a>
			</p>

			<p>
				<small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a>
				</small>
			</p>
		</footer>
	</div>

	<section>

		<div class="title">
			<h1>What is soma.js?</h1>
			<a class="anchor" name="what-is-soma-js"></a>
		</div>

		<p>soma.js is a framework created to build scalable and maintainable javascript applications.</p>

		<p>The success to build large-scale applications will rely on smaller single-purposed parts of a larger system. soma.js provides tools to create a <a href="http://en.wikipedia.org/wiki/Loose_coupling" target="_blank">loosely-coupled</a> architecture broken down into smaller pieces.</p>
		<p>The different components of an application can be modules, models, views, plugins or widgets. soma.js will not dictate its own structure, the framework can be used as a <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" target="_blank">model-view-controller</a> framework, can be used to create independent modules, sandboxed widgets or anything that will fit a specific need.</p>
		<p>For a system to grow and be maintainable, its parts must have a very limited knowledge of their surrounding. The components must not be tied to each other (<a href="http://en.wikipedia.org/wiki/Law_of_Demeter" target="_blank">Law of Demeter</a>), in order to be re-usable, interchangeable and allow the system to scale up.</p>
		<p>soma.js is a set of tools and design patterns to build a long term architecture that are decoupled and easily testable. The tools provided by the framework are <a href="http://en.wikipedia.org/wiki/Dependency_injection" target="_blank">dependency injection</a>, <a href="http://en.wikipedia.org/wiki/Observer_pattern" target="_blank">observer pattern</a>, <a href="http://en.wikipedia.org/wiki/Mediator_pattern" target="_blank">mediator pattern</a>, <a href="http://en.wikipedia.org/wiki/Facade_pattern" target="_blank">facade pattern</a>, <a href="http://en.wikipedia.org/wiki/Command_pattern" target="_blank">command pattern</a>, <a href="http://en.wikipedia.org/wiki/Object-oriented_programming" target="_blank">OOP</a> utilities and a DOM manipulation template engine as an optional plugin.</p>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Download</h1>
			<a class="anchor" name="download"></a>
		</div>

		<h3>Browser</h3>
		<p><a href="https://github.com/soundstep/soma-template/tree/master/build" class="button icon tag" target="_blank">download soma.js</a></p>
		<p>You can also download a <a href="https://github.com/somajs/somajs/zipball/master">zip file</a> containing everything. Finally, add the script to your page:</p>
		<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;soma.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></pre></div>
		<h3>Node.js</h3>
		<div class="highlight"><pre><span class="nx">$</span> <span class="nx">npm</span> <span class="nx">install</span> <span class="nx">soma.js</span></pre></div>
		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">soma</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;soma.js&quot;</span><span class="p">);</span></pre></div>
		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Quick start</h1>
			<a class="anchor" name="quick-start"></a>
		</div>

		<p>Here is an example of what a soma.js application could look like. In this case, following the MVC pattern.</p>
		<p>The application contains a model that holds data, a template that manipulate a DOM element and an application instance that hook them up. The application instance must extend a framework function, while the other entities (model and template) are plain javascript function free of framework code.</p>
		<p>The template function receives a template instance, a DOM element and the model, using dependency injection.</p>

		<div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;app&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span><span class="cp">{{</span><span class="nv">content</span><span class="cp">}}</span><span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script&gt;</span>

  <span class="c1">// function model containing data (text to display)</span>
  <span class="kd">var</span> <span class="nx">Model</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="s2">&quot;Hello world!&quot;</span>
  <span class="p">};</span>

  <span class="c1">// function template that will update the DOM</span>
  <span class="kd">var</span> <span class="nx">Template</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="c1">// application function</span>
  <span class="kd">var</span> <span class="nx">QuickStartApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// model mapping rule so it can be injected in the template</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="nx">Model</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="c1">// create a template for a specific DOM element</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">createTemplate</span><span class="p">(</span><span class="nx">Template</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.app&#39;</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="c1">// create application</span>
  <span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QuickStartApplication</span><span class="p">();</span>

<span class="nt">&lt;/script&gt;</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/UqqsbcqHZGM9aWzgPV50?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Application instance</h1>
			<a class="anchor" name="application-instance"></a>
		</div>

		<p>The first step to build a soma.js application is to create an application instance. This is the only moment a framework function has to be extended, all the other entities can be re-usable plain javascript function, and framework agnostic.</p>
		<p>The application instance will execute two functions so you can setup the architecture needed: the init and the start functions.</p>
		<p>Here are different syntax to create an application instance.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApplication</span><span class="p">();</span>
</pre></div>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">();</span>

<span class="nx">MyApplication</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">MyApplication</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApplication</span><span class="p">();</span>
</pre></div>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">();</span></pre></div>

		<p>The constructor of an application can be overridden to implement your own. The "parent" constructor will have to be called so the framework can bootstrap. Click here to <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call" target="_blank">learn more about chaining constructor</a>.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">constructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">param</span> <span class="o">=</span> <span class="nx">param</span><span class="p">;</span>
    <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;init with param:&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">param</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApplication</span><span class="p">(</span><span class="s2">&quot;my application parameter&quot;</span><span class="p">);</span>
</pre></div>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Core elements</h1>
			<a class="anchor" name="core-elements"></a>
		</div>

		<p>The framework core elements to help you build your own structure are the following:</p>
		<ul>
			<li>Dependency injection (injector property)</li>
			<li>Observer pattern (dispatcher property)</li>
			<li>Command pattern (commands property)</li>
			<li>Mediator pattern (mediators property)</li>
			<li>Facade pattern (instance property)</li>
		</ul>
		<p>They are available in the application or in other entities using dependency injection.</p>
		<p>Here is how to get their references in the application instance.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">;</span> <span class="c1">// dependency injection pattern</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">;</span> <span class="c1">// observer pattern</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">;</span> <span class="c1">// command pattern</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mediators</span><span class="p">;</span> <span class="c1">// mediator pattern</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">instance</span><span class="p">;</span> <span class="c1">// facade pattern</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

		<p>Here are two different syntax to get their references in other entities. The injector will either send the core elements in the constructor or set the corresponding properties.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Entity</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">injector</span><span class="p">,</span> <span class="nx">dispatcher</span><span class="p">,</span> <span class="nx">commands</span><span class="p">,</span> <span class="nx">mediators,</span> <span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>

<span class="p">};</span>
</pre></div>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Entity</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">injector</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">commands</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">mediators</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Dependency injection</h1>
			<a class="anchor" name="dependency-injection"></a>
		</div>

		<p><a href="https://github.com/soundstep/infuse.js" target="_blank">infuse.js</a> is the dependency injection library developed for soma.js, <a href="https://github.com/soundstep/infuse.js" target="_blank">click here to see the infuse.js documentation and tests</a>.</p>

		<div class="subtitle">
			<h2>What is dependency injection?</h2>
			<a class="anchor" name="what-is-dependency-injection"></a>
		</div>

		<p><a href="http://en.wikipedia.org/wiki/Dependency_injection" target="_blank">Dependency injection</a> (DI) and <a href="http://en.wikipedia.org/wiki/Inversion_of_control" target="_blank">inversion of control</a> (IOC) are two terms often used in programming. Before explaining the benefits of dependency injection and how it is implemented in soma.js, here is a naive and hopefully accessible explanation.</p>

		<p>A dependency is the relationships between two objects. This relationship is often characterized by side effects that can be problematic and undesirable at times.</p>
		<p>Dependency injection is the process in which you are setting up rules that determine how dependencies are injected into an object automatically, as opposed to have hard-coded dependencies.</p>
		<p>An object "A" that needs an object "B" to work has a direct dependency to it. Code where the components are dependent on nearly everything else is a "highly-coupled code". The result is an application that is hard to maintain, with components that are hard to change without impacting on others.</p>
		<p>Dependency injection is an antidote for highly-coupled code. The cost required to wire objects together falls to next to zero.</p>
		<p>Dependency Injection is based on the following assumptions:</p>
		<ul>
			<li>Tight coupling of object implementations is always bad. </li>
			<li>A dependent function is never a good place to create a dependency.</li>
		</ul>
		<p>Consider the process of using the dependency injection pattern as centralizing knowledge of all dependencies and their implementations.</p>
		<p>A common dependency injection system has a separate object (an injector, often called container), that will instantiate new objects and populate them with what they needs: the dependencies. Dependency injection is a useful pattern to solve nested dependencies, as they can chain and be nested through several layers of the application.</p>
		<p>The benefits of dependency injection are:</p>
		<ul>
			<li>More re-usable components.</li>
			<li>Improved code maintenance.</li>
			<li>More testable components (mocking object).</li>
			<li>More readable code (reduction of boilerplate code).</li>
		</ul>

		<div class="subtitle">
			<h2>Using dependency injection in soma.js</h2>
			<a class="anchor" name="using-dependency-injection-in-somajs"></a>
		</div>

		<p>Dependency injection involves a way of thinking called the <a href="http://en.wikipedia.org/wiki/Hollywood_principle" target="_blank">Hollywood principle</a> "don't call us, we'll call you". This is exactly how it works in soma.js. Entities will ask for their dependencies using properties and/or constructor parameters.</p>
		<p>Using dependency injection implies creating rules, so the injector knows "what" and "how" to populate the dependencies.</p>
		<p>These are called "mapping rules". A rule is simply "mapping" a name (string) to an "object" (string, number, boolean, function, object, and so on). These mapping names are used to inject the corresponding objects in either a javascript constructor or a variable.</p>

		<div>
			<h4>A simple example</h4>
		</div>

		<p>In the following example, two plain javascript functions will be instantiated and injected.</p>
		<ul>
			<li>The Config function has a "debugMode" constructor parameter that happened to be an injection name (mapping rule associated), the corresponding boolean value will be injected into it.</li>
			<li>The Model function contains two constructor parameters that also are injection names. A config instance and a boolean value will be injected into the corresponding parameters.</li>
			<li>Two mapping rules are defined, one using the "mapClass" method used to map functions and one using the "mapValue" method used to map objects that are not meant to be instantiated.</li>
			<li>In the last line, the Model instance is instantiated by the injector, which will take care of all the dependencies and nested dependencies needed.</li>
		</ul>

		<div class="highlight"><pre><span class="c1">// simple function that will be injected into the model</span>
<span class="c1">// a boolean dependency is injected</span>
<span class="kd">var</span> <span class="nx">Config</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">debugMode</span><span class="p">)</span> <span class="p">{</span>

<span class="p">};</span>
<span class="c1">// simple function in which a config instance and a boolean is injected</span>
<span class="kd">var</span> <span class="nx">Model</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">debugMode</span><span class="p">)</span> <span class="p">{</span>

<span class="p">};</span>
<span class="c1">// mapping rule: map the string &quot;config&quot; to the function Config</span>
<span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="nx">Config</span><span class="p">);</span>
<span class="c1">// mapping rule: map the string &quot;debugMode&quot; to a boolean</span>
<span class="nx">injector</span><span class="p">.</span><span class="nx">mapValue</span><span class="p">(</span><span class="s2">&quot;debugMode&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// instantiate the model using the injector</span>
<span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="nx">injector</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span><span class="nx">Model</span><span class="p">);</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/C7m5qE7hYpUnQK6a9rNp?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div>
			<h4>Singleton injection</h4>
		</div>

		<p>By default, every single time the injector will find a dependency that needs to be instantiated (such as the Config function in the previous example), the injector will instantiate a new one. A third parameter can be used when defining the "mapClass" rule: the "singleton" parameter. The effect will be that the injector will instantiate the function the first time it is asked, and send that same instance when it is asked again. This is useful to share an instance with several other components.</p>

		<div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="nx">Config</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span></pre></div>

		<p><a href="http://plnkr.co/edit/ZLv66EglhbBGyieujxG3?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="back"><a href="#">top</a></div>

		<div>
			<h4>Where can injection be used?</h4>
		</div>

		<p>Injection can be used in any function instantiated by the injector:</p>
		<ul>
			<li>Entities manually created using the injector</li>
			<li>Dependencies of entities as they are automatically created by the injector</li>
			<li>Commands as they are internally created by the injector</li>
			<li>Mediators as they are internally created by the injector</li>
			<li>Templates as they are internally created by the injector</li>
		</ul>

		<p>In the following example, dispatching a event will instantiate and execute a Command function, which will instantiate a Model function as it needs this dependency, which will instantiate a Config function as it needs this dependency.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Config</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Config instantiated&quot;</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Model</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Model instantiated with a config injected:&quot;</span><span class="p">,</span> <span class="nx">config</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Command</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">execute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Command executed with a model injected:&quot;</span><span class="p">,</span> <span class="nx">model</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// mapping rule: map the string &quot;config&quot; to the function Config</span>
<span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="nx">Config</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// mapping rule: map the string &quot;model&quot; to the function Model</span>
<span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="nx">Model</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// command mapped to an event</span>
<span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">,</span> <span class="nx">Command</span><span class="p">);</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/jN2OzC3wbcmzvHJ1XgDP?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

	</section>

	<section>

		<div class="title">
			<h1>Communication</h1>
			<a class="anchor" name="communication"></a>
		</div>

		<p><a href="https://github.com/soundstep/soma-events" target="_blank">soma-events</a> is the observer library developed for soma.js, <a href="https://github.com/soundstep/soma-events" target="_blank">click here to see the soma-events documentation and tests</a>.</p>

		<div class="subtitle">
			<h2>Native event system</h2>
			<a class="anchor" name="native-event-system"></a>
		</div>

		<p>Communicating between entities in an application is an important part. Object orientated programming is all about states of objects and their interaction. Certain objects need to be informed about changes in others objects, some others need to inform the rest of the application and some others will do both.</p>
		<p>The <a href="http://en.wikipedia.org/wiki/Observer_pattern" target="_blank">Observer pattern</a> is a design pattern used to communicate between objects and reduce the dependencies. One the core elements of soma.js is the "dispatcher", an event system used to dispatch and listen to events throughout the entire application.</p>
		<p>For example, a model component that receives data can use the dispatcher to notify the rest of the application that the data has changed. A view component can use the dispatcher to inform other components that a user input has just happened.</p>
		<p>The library used to dispatch and listen to events (<a href="https://github.com/soundstep/soma-events" target="_blank">soma-events</a>) is not a simple publish-subscribe library. In case of an application related to the DOM (in opposition to a node.js application), the events used are real <a href="http://www.w3.org/TR/DOM-Level-3-Events/" target="_blank">DOM events</a>, and the dispatcher shares a common interface to DOM 3 events. The result is that the soma.js dispatcher can be interchanged with a DOM Element for a complete application decoupling.</p>
		<p>The <a href="https://github.com/soundstep/soma-events" target="_blank">soma-events</a> library provides a custom dispatcher (usable in non-DOM environment), a event wrapper that will create the right events depending on the environment (webkit, internet explorer, non-DOM environment), and some shortcuts for ease-of-use.</p>
		<p>Note: the shortcuts are not part of the DOM 3 events specification).</p>

		<div class="subtitle">
			<h2>Creating and dispatching events</h2>
			<a class="anchor" name="creating-and-dispatching-events"></a>
		</div>

		<p>To dispatch an event, the first step is to create it. There are four ways to create events:</p>
		<ul>
			<li>Using a "dispatch" shortcut</li>
			<li>Instantiating the event wrapper</li>
			<li>Extending the event wrapper and instantiating the custom event</li>
			<li>Creating real DOM events</li>
		</ul>

		<div>
			<h4>Create and dispatch an event using the dispatcher shortcut</h4>
		</div>

		<p>Creating an event and dispatching it with the dispatcher shortcut is the easiest way. Note that the shortcut syntax is not part of the DOM 3 specification if it matters for the application.</p>

		<div class="highlight"><pre><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">);</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;another-event&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span><span class="s2">&quot;parameters&quot;</span><span class="p">});</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/ypcBB9hJEZt7UdSvVujr?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div>
			<h4>Create and dispatch an event instantiating the event wrapper</h4>
		</div>

		<p>An instance of the event wrapper can be created, and dispatched following the DOM 3 dispatchEvent interface.</p>

		<div class="highlight"><pre><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">));</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span><span class="s2">&quot;parameters&quot;</span><span class="p">}));</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/eRFQuQVQRxAEGLh784a4?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div>
			<h4>Create and dispatch an event instantiating an extended event wrapper</h4>
		</div>

		<p>The event wrapper can also be extended to specify custom variables or change the implementation.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyEvent</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">constructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">bubbles</span><span class="p">,</span> <span class="nx">cancelable</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">bubbles</span><span class="p">,</span> <span class="nx">cancelable</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">MyEvent</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">));</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">MyEvent</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span><span class="s2">&quot;parameters&quot;</span><span class="p">}));</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/f4pKAQ0YR3GWkTjYRJhk?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div>
			<h4>Create and dispatch an event using DOM Native methods</h4>
		</div>

		<p>In case an entity requires a very strict decoupling, the dispatcher can be switch to a DOM Element (see the <a href="https://github.com/soundstep/soma-events" target="_blank">soma-event documentation</a>), and a DOM Event can be used rather than using the event wrapper.</p>
		<p>The goal of the event wrapper is hiding the complexity of creating cross-browser events, solving cross-browser different implementations and creating objects that represents events for node.js. The following example will only work in browsers that support the "document.createEvent" method.</p>

		<div class="highlight"><pre><span class="c1">// swap the dispatcher to a DOM Element (window in this example)</span>
<span class="nx">injector</span><span class="p">.</span><span class="nx">removeMapping</span><span class="p">(</span><span class="s2">&quot;dispatcher&quot;</span><span class="p">);</span>
<span class="nx">injector</span><span class="p">.</span><span class="nx">mapValue</span><span class="p">(</span><span class="s2">&quot;dispatcher&quot;</span><span class="p">,</span> <span class="nb">window</span><span class="p">);</span>
<span class="c1">// listen to an event</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;event received:&#39;</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// dispatch an event</span>
<span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="s2">&quot;Event&quot;</span><span class="p">);</span>
<span class="nx">event</span><span class="p">.</span><span class="nx">initEvent</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">);</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/9oOdvqPtMdUpg6DuKCLS?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="subtitle">
			<h2>Listening to events</h2>
			<a class="anchor" name="listening-to-events"></a>
		</div>

		<p>The dispatcher implements the same interface as the DOM Event specification, the methods "addEventListener" and "removeEventListener" can be used to listen and stop listening to events.</p>

		<div><h4>A simple example</h4></div>

		<p>In the following example, an event is dispatched from the application instance, and listened to both in the application instance and a view entity.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">View</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dispatcher</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;event received in a view:&#39;</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span><span class="nx">View</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// listen to an event</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;event received:&#39;</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="c1">// dispatch an event</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApplication</span><span class="p">();</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/GXzRmRwbWNpBnykBqBpS?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div><h4>Event handlers scope and binding</h4></div>

		<p>As with events dispatched from the DOM, the scope of the event handlers (this) might not be the expected scope. To solve this common javascript problem, a "bind" method can be used.</p>
		<p><code>Function.prototype.bind</code> is part of ECMAScript 5 and soma.js has implemented a shim for older browsers. <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind" target="_blank">Click here for more information about the bind method</a>.</p>
		<p>In the following example, one event is dispatched and two functions are listening to it. In the first function, the "this" is the window. In the second function the "this" is the application instance as the bind function changes the scope of the event handler, making the instance variable accessible.</p>

		<div class="highlight"><pre><span class="c1">// instance variable</span>
<span class="k">this</span><span class="p">.</span><span class="nx">myVariable</span> <span class="o">=</span> <span class="s2">&quot;myValue&quot;</span><span class="p">;</span>

<span class="c1">// listen to an event without binding</span>
<span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// &quot;this&quot; is window</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;instance variable not accessible:&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">myVariable</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// listen to an event with binding</span>
<span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// &quot;this&quot; is the application instance</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;instance variable accessible:&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">myVariable</span><span class="p">);</span>
<span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

<span class="c1">// dispatch an event</span>
<span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">);</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/sYuaBogeYGgT7AeNCWme?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<p>A quick note about removing listeners. The bind method creates a new function, removing a listener using the bind method will not work as the event handler will be a new function (<a href="https://github.com/soundstep/soma-events" target="_blank">see some-event documentation</a>).</p>
		<p>Here is the solution to properly remove listeners using the bind method.</p>

		<div class="highlight"><pre><span class="c1">// event handler</span>
<span class="kd">var</span> <span class="nx">eventHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// will not be triggered as the listener is properly removed</span>
<span class="p">}</span>
<span class="c1">// bound event handler reference</span>
<span class="kd">var</span> <span class="nx">boundEventHandler</span> <span class="o">=</span> <span class="nx">eventHandler</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="c1">// listen to an event</span>
<span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="nx">boundEventHandler</span><span class="p">);</span>
<span class="c1">// stop listening to an event</span>
<span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="nx">boundEventHandler</span><span class="p">);</span>
<span class="c1">// dispatch an event</span>
<span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">);</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/vGRDmdxKeiGY61lDKSUt?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="subtitle">
			<h2>Send parameters</h2>
			<a class="anchor" name="send-parameters"></a>
		</div>

		<p>Parameters can be sent when dispatching events, so the events handlers can receive information. The parameters are store on the <code>event.params</code> property of an event.</p>

		<div class="highlight"><pre><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span><span class="s1">&#39;some data&#39;</span><span class="p">});</span>
<span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span><span class="s1">&#39;some data&#39;</span><span class="p">}));</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/FFv5llnIS4Tmb70MeLy5?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Command</h1>
			<a class="anchor" name="command"></a>
		</div>

		<p>A <a href="http://en.wikipedia.org/wiki/Command_pattern" target="_blank">command</a> is behavioral design pattern to help reducing dependencies. An object is used to encapsulate the information needed to call a method, including the object owning the method, the object itself and any parameters.</p>
		<p>Concretely, a command is a function instantiated by the framework, created for any re-usable action that could be performed in various places of the application. A command is meant to be created, used and discarded straight away. A command should never be used to hold data, and should be executable at any time without causing errors in the system.</p>

		<div class="subtitle">
			<h2>Create commands</h2>
			<a class="anchor" name="create-commands"></a>
		</div>

		<p>A command in soma.js is nothing more than a simple function that contains an <code>execute</code> method that will receive the event instance used to trigger it. Dependency injection can be used to retrieve useful objects.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Command</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">myModel</span><span class="p">,</span> <span class="nx">myView</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">execute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>

		<div class="subtitle">
			<h2>Manage commands</h2>
			<a class="anchor" name="manage-commands"></a>
		</div>

		<div><h4>Add a command</h4></div>

		<p>Commands in soma.js are triggered using events. This makes possible for the application actors to, not only execute commands, but also listen to events used to trigger the commands.</p>
		<p>The <code>commands</code> core element is used to managed the commands. It is a good practice, unless you are building self-contained modules, to add all the commands in the same place, such as the application instance. This would give a good overview for a potantial new developer to get an idea of what's possible in the application using the commands.</p>

		<div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">,</span> <span class="nx">Command</span><span class="p">);</span></pre></div>

		<div><h4>Remove a command</h4></div>

		<p>The <code>commands</code> core element contains several useful methods to manage the commands, such as <code>has</code>, <code>get</code> and <code>getAll</code>. To remove a command, the <code>remove</code> method can be used.</p>

		<div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">);</span></pre></div>

		<div class="subtitle">
			<h2>A simple command example</h2>
			<a class="anchor" name="simple-command-example"></a>
		</div>

		<p>The following example contains a <code>Navigation</code> model, its role is to display a screen using an ID. A Command is created to call the navigation method. The command is mapped to a "show-screen" event, which is used to send the ID of a screen. This setup makes possible, for any actor of the application, to dispatch an event to show a screen.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Navigation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
<span class="nx">Navigation</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">showScreen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Display screen:&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">Command</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">navigation</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">execute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Command executed with parameter:&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">params</span><span class="p">);</span>
    <span class="nx">navigation</span><span class="p">.</span><span class="nx">showScreen</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">params</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;navigation&quot;</span><span class="p">,</span> <span class="nx">Navigation</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;show-screen&quot;</span><span class="p">,</span> <span class="nx">Command</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;show-screen&quot;</span><span class="p">,</span> <span class="s2">&quot;home&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApplication</span><span class="p">();</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/hPxftFSFhtmMe5D0hdbT?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="subtitle">
			<h2>Flow control</h2>
			<a class="anchor" name="flow-control"></a>
		</div>

		<p>Being able to control the flow of an application is important. Some components might decide to execute a command, but some other components might have the need to monitor or even interrupt the application flow. A good example could be a "logout" command in an editor application. A menu component can decide to execute this command, but the editor should be able to intercept and interrupt it in case the user didn't save his current file.</p>
		<p>As the commands are using events to be triggered, the DOM Event provides the necessary tools to monitor (addEventListener) and interrupt a command (event.preventDefault).</p>
		<p>In the following example, a command is executed and an external <code>Monitor</code> entity is able to monitor this command by listening to the event.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Monitor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dispatcher</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;some-event&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Command monitored&quot;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Command</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">execute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Command executed&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">MyApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">,</span> <span class="nx">Command</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span><span class="nx">Monitor</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;some-event&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApplication</span><span class="p">();</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/VHLPtSJgsBNgNFzgf1x6?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<p>In the following example, the <code>start</code> method dispatch an event to logout a user. The <code>EditorModel</code> is able to monitor the logout command and interrupt it.</p>
		<p>The initiator of the command can decide when dispatching the event, if another component should be able to interrupt it. A DOM Event has a <code>cancelable</code> property that should be set to true when dispatched so another component can interrupt it using the <code>event.preventDefaut()</code> method.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">EditorModel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dispatcher</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;logout&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Logout event received in EditorModel&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">fileSaved</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Interupt logout command&#39;</span><span class="p">);</span>
      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">LogoutCommand</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">execute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Logout user&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">EditorApplication</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;logout&quot;</span><span class="p">,</span> <span class="nx">LogoutCommand</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span><span class="nx">EditorModel</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// dispatch a cancelable event</span>
    <span class="c1">// dispatch(eventType, parameters, bubbles, cancelable)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&quot;logout&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">EditorApplication</span><span class="p">();</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/xQtwi2nMDAh3Z2zL1iz0?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Mediator</h1>
			<a class="anchor" name="mediator"></a>
		</div>

		<p>A mediator is a behavioral design pattern that is used to reduce dependencies. Concretely, a mediator is an object that represents another object, the communication between objects can be encapsulated within the mediators rather than the objects it represents, reducing coupling.</p>

		<div class="subtitle">
			<h2>Create mediators</h2>
			<a class="anchor" name="create-mediators"></a>
		</div>

		<p>The core element <code>mediators</code> can be used to create mediators. It contains a single <code>create</code> method as the mediators and objects represented are not stored by the framework.</p>
		<p>The <code>create</code> method requires two parameters. The first parameter is a function instantiated by the framework, the mediator itself. The second parameter is either a single object or a list of objects (array, node list, and so on).</p>
		<p>Mediators are also useful to represent several targets with the same function (<a href="http://en.wikipedia.org/wiki/Don't_repeat_yourself" target="_blank">DRY</a>). The <code>create</code> method will instantiate as many mediators needed and return them.</p>
		<p>A <code>target</code> parameter will be injected to get a reference of the object represented.</p>

		<div class="highlight"><pre><span class="kd">function</span> <span class="nx">Mediator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// target is the object represented</span>
<span class="p">};</span>
<span class="c1">// create mediator with a single object</span>
<span class="kd">var</span> <span class="nx">mediators</span> <span class="o">=</span> <span class="nx">mediators</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">MyMediator</span><span class="p">,</span> <span class="nx">object</span><span class="p">);</span>
<span class="c1">// create mediator with a list of objects</span>
<span class="kd">var</span> <span class="nx">mediators</span> <span class="o">=</span> <span class="nx">mediators</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">MyMediator</span><span class="p">,</span> <span class="p">[</span><span class="nx">object1</span><span class="p">,</span> <span class="nx">object2</span><span class="p">,</span> <span class="nx">object3</span><span class="p">]);</span>
</pre></div>

		<div class="subtitle">
			<h2>Simple mediator example</h2>
			<a class="anchor" name="simple-mediator-example"></a>
		</div>

		<p>In the following example, a mediator that represents a DOM Element is created, paradoxically called "view" on purpose (see next example).</p>
		<p>The mediator updates its target, a DOM Element, when it receives a specific event.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">TitleView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">dispatcher</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// listen to the event &quot;render-title&quot; to update the target (DOM Element)</span>
  <span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;render title&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">target</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Application</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// create a mediator that represents a DOM Element</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mediators</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">TitleView</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// dispatch an event to trigger an action in the mediator</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s1">&#39;render title&#39;</span><span class="p">,</span> <span class="s2">&quot;This is a title&quot;</span><span class="p">);</span>
  <span class="p">},</span>
<span class="p">});</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/E9PND7pyY81QT9u8cRlH?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="subtitle">
			<h2>Decoupling communication</h2>
			<a class="anchor" name="decoupling-communication"></a>
		</div>

		<p>The previous example can be taken even further to create a highly re-usable object. The view can provide a set of methods to update its content, and the communication with the framework can be moved to another mediator.</p>
		<p>Responsibilities will be completely separated as the view will only take care of displaying content, and the mediator will be responsible of providing the view the right content, at the right moment.</p>
		<p>The following example also show how to use a single view function and a single mediator function, to handle multiple DOM Elements.</p>

		<div class="highlight"><pre><span class="nt">&lt;h1</span> <span class="na">data-id=</span><span class="s">&#39;first&#39;</span><span class="nt">&gt;&lt;/h1&gt;</span>
<span class="nt">&lt;h1</span> <span class="na">data-id=</span><span class="s">&#39;second&#39;</span><span class="nt">&gt;&lt;/h1&gt;</span>
<span class="nt">&lt;h1</span> <span class="na">data-id=</span><span class="s">&#39;third&#39;</span><span class="nt">&gt;&lt;/h1&gt;</span>

<span class="c1">// model containing title strings</span>
<span class="kd">var</span> <span class="nx">TitleModel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">first</span><span class="o">:</span> <span class="s1">&#39;First title&#39;</span><span class="p">,</span>
    <span class="nx">second</span><span class="o">:</span> <span class="s1">&#39;Second title&#39;</span><span class="p">,</span>
    <span class="nx">third</span><span class="o">:</span> <span class="s1">&#39;Third title&#39;</span>
  <span class="p">};</span>
<span class="p">};</span>
<span class="nx">TitleModel</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getTitle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
<span class="p">};</span>

<span class="c1">// view representing a DOM element</span>
<span class="kd">var</span> <span class="nx">TitleView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">target</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">TitleView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setTitle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// mediator representing a view</span>
<span class="kd">var</span> <span class="nx">TitleMediator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">dispatcher</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">dispatcher</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;render title&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-id&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">getTitle</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="nx">target</span><span class="p">.</span><span class="nx">setTitle</span><span class="p">(</span><span class="nx">title</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">Application</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// map model to inject in mediators</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="nx">TitleModel</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">// create views (mediators representing a DOM element)</span>
    <span class="kd">var</span> <span class="nx">views</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mediators</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">TitleView</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">));</span>
    <span class="c1">// create mediators (mediators representing a view)</span>
    <span class="kd">var</span> <span class="nx">mediators</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mediators</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">TitleMediator</span><span class="p">,</span> <span class="nx">views</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// dispatch an event to render the titles</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s1">&#39;render title&#39;</span><span class="p">,</span> <span class="s2">&quot;This is a title&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">();</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/vb4jexiMS6oejbWHPAvi?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Template</h1>
			<a class="anchor" name="template"></a>
		</div>

		<p><a href="http://soundstep.github.io/soma-template/" target="_blank">soma-template</a> is an optional DOM template engine library implemented in soma.js, <a href="http://soundstep.github.io/soma-template/" target="_blank">click here to see the soma-template documentation and tests</a>.</p>

		<div class="subtitle">
			<h2>Load the soma-template plugin</h2>
			<a class="anchor" name="load-template-plugin"></a>
		</div>

		<p>Simply load the template engine just after loading the soma.js framework. No further actions are needed to use the soma-template library.</p>

		<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;soma.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;soma-template.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>

		<div class="subtitle">
			<h2>Create a template</h2>
			<a class="anchor" name="create-a-template"></a>
		</div>

		<p>The framework provides a method <code>createTemplate</code> that will instantiate a mediator and receive a <code>template</code>, <code>scope</code> and <code>element</code> parameters so that the DOM can be manipulated in an easy way.</p>

		<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Template</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>

<span class="p">};</span>

<span class="k">this</span><span class="p">.</span><span class="nx">createTemplate</span><span class="p">(</span><span class="nx">Template</span><span class="p">,</span> <span class="nx">domElement</span><span class="p">);</span>
</pre></div>

		<div class="subtitle">
			<h2>Simple template example</h2>
			<a class="anchor" name="simple-template-example"></a>
		</div>

		<p>In the following example a template is created using a template function and a reference to a DOM Element. The template will ask the injector a model that contains the data to be displayed.</p>

		<div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;app&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span><span class="cp">{{</span><span class="nv">content.title</span><span class="cp">}}</span><span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">data-repeat=</span><span class="s">&quot;item in content.items&quot;</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">$index</span><span class="cp">}}</span> - <span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="c1">// function model containing data (text to display)</span>
<span class="kd">var</span> <span class="nx">Model</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;This is a title&quot;</span><span class="p">,</span>
    <span class="nx">items</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;First item&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Second item&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Third item&quot;</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// function template that will update the DOM</span>
<span class="kd">var</span> <span class="nx">Template</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">scope</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="p">};</span>

<span class="c1">// application function</span>
<span class="kd">var</span> <span class="nx">Application</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// model mapping rule so it can be injected in the template</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="nx">mapClass</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="nx">Model</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">// create a template for a specific DOM element</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">createTemplate</span><span class="p">(</span><span class="nx">Template</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.app&#39;</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// create application</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">();</span>
</pre></div>

		<p><a href="http://plnkr.co/edit/jqNzBAow23H7uZrZ974m?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>

		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>OOP</h1>
			<a class="anchor" name="oop"></a>
		</div>

		<p>Javascript is an object oriented language, but do not have built-in classes, private members, inheritance, interfaces and other common features found in other languages.</p>
		<p>There are a lot of debates whether you should emulate classes, but the fact is, some inheritance capabilities are needed not to duplicate code.</p>

		<div class="subtitle">
			<h2>Inheritance</h2>
			<a class="anchor" name="inheritance"></a>
		</div>

		<p></p>



		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Plugins</h1>
			<a class="anchor" name="plugins"></a>
		</div>

		<p></p>
		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Tools</h1>
			<a class="anchor" name="tools"></a>
		</div>

		<p></p>
		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Demos</h1>
			<a class="anchor" name="demos"></a>
		</div>

		<p></p>
		<div class="back"><a href="#">top</a></div>

	</section>

	<section>

		<div class="title">
			<h1>Tests</h1>
			<a class="anchor" name="tests"></a>
		</div>

		<p></p>
		<div class="back"><a href="#">top</a></div>

	</section>

	<section class="last">

		<div class="title">
			<h1>Browser support</h1>
			<a class="anchor" name="browser-support"></a>
		</div>

		<p></p>
		<div class="back"><a href="#">top</a></div>

	</section>


</div>

<script src="assets/js/libs/jquery-1.8.2.min.js"></script>
<script src="assets/js/libs/modernizr.js"></script>
<script src="assets/js/libs/scale.fix.js"></script>
<script src="assets/js/app.js"></script>

</body>
</html>