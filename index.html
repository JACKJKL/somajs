<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<title>soma.js</title>
	<meta charset="utf-8">
	<meta name="description" content="soma.js is a javascript model-view-controller framework that is meant to help developers to write loosely-coupled applications to increase scalability and maintainability.">
	<meta name="keywords" content="soma soma.js js javascript framework mvc somacore soundstep design pattern events tools toolset html css ria mobile desktop prototype loose-coupling model view controller native development">
	<meta name="viewport" content="initial-scale=1.0, minimum-scale=1, maximum-scale=1, width=device-width" />

	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	
	<link rel="stylesheet" href="gh-buttons/gh-buttons.css"/>
	<link rel="stylesheet" href="codemirror/css/codemirror.css"/>
	<link rel="stylesheet" href="codemirror/theme/eclipse.css"/>
	<link rel="stylesheet" href="styles/css/main.css"/>
	<noscript>
		<link rel="stylesheet" href="styles/css/no-js.css"/>
	</noscript>

	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-28629754-1']);
		_gaq.push(['_trackPageview']);
	</script>
</head>
<body>

<div id="bg">
	<div id="bg-image"></div>
	<div id="bg-transparent">
		<div id="bg-gradient"></div>
	</div>
</div>

<div id="container">
	<script type="text/javascript" src="js/app/init.js"></script>

	<header>
		<h1>soma.js</h1>
	</header>

	<nav id="nav">
		<h1 class="hidden">Navigation</h1>
		<ul id="main">
			<li id="main-about"><a href="#about">About</a></li>
			<li id="main-tutorial"i><a href="#tutorial">Tutorial</a>
				<ul id="tuto">
					<li id="tuto-createapp"><a href="#createapp">Create an application</a></li>
					<li id="tuto-createwire"><a href="#createwire">Create a wire</a></li>
					<li id="tuto-createmodel"><a href="#createmodel">Create a model</a></li>
					<li id="tuto-createview"><a href="#createview">Create a view</a></li>
					<li id="tuto-createcommand"><a href="#createcommand">Create a command</a></li>
					<li id="tuto-appflow"><a href="#appflow">Application flow</a></li>
					<li id="tuto-helloworld"><a href="#helloworld">Hello world application</a></li>
					<li id="tuto-createplugin"><a href="#createplugin">Create a plugin</a></li>
				</ul>
			</li>
			<li id="main-demos"><a href="#demos">Demos</a></li>
			<li id="main-plugins"><a href="#plugins">Plugins</a></li>
			<li id="main-download"><a href="#download">Downloads</a></li>
			<li id="main-docs"><a href="#docs" target="_blank">Documentation</a></li>
			<li id="main-discussion"><a href="#discussion" target="_blank">Discussion</a></li>
			<li id="main-browsers"><a href="#browsers">Browsers information</a></li>
		</ul>
	</nav>

	<div id="content">

		<section id="about">
			<a name="about"></a>
			<h1>What is soma.js?</h1>
			<p>soma.js is a javascript <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" target="_blank">model-view-controller</a> (MVC) framework that is meant to help developers to write <a href="http://en.wikipedia.org/wiki/Loose_coupling" target="_blank">loosely-coupled</a> applications to increase scalability and maintainability.</p>
			<p>The main idea behind the MVC pattern is to separate the data (model), the user interface (view) and the logic of the application (controller). They must be independent and should not know about each other in order to increase the scalability of the application.</p>
			<p>soma.js is providing tools to make the three parts "talks" to each other, keeping the view and the model free of framework code, using only native events that can be dispatched from either the framework of the DOM itself.</p>
			<h1>When to use soma.js?</h1>
			<p>One of the great things about javascript is that it scales up with the skill of the developers. Javascript is suitable to write small functions to handle some basics in a site, but javascript is also powerful enough to handle more complex applications, this is where soma.js will shine.</p>
			<p>The primary goal of the framework is to help developers to write "decoupled" modules. The amount of code might be greater than what you can achieve with other frameworks because the goals are different.</p>
			<p>For that reason, while you can use the framework for anything, soma.js might not be the best option for small tasks. For larger applications, where it is important to easily refactor and swap out modules, important to work in large team or collaborate with developers, soma.js will be a great tools and is made for that.</p>
			<p>soma.js is suitable to work for both mobile and desktop.</p>
			<h1>Tools at your disposition</h1>
			<p>The framework makes an heavy use of the <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#observerpatternjavascript" target="_blank">Observer pattern</a> using native javascript events. Here is a quote from <a href="http://addyosmani.com/" target="_blank">Addy Osmani</a> about the Observer pattern:</p>
			<p class="note">The motivation behind using the observer pattern is where you need to maintain consistency between related objects without making classes tightly coupled. For example, when an object needs to be able to notify other objects without making assumptions regarding those objects.</p>
			<p>The framework also provides tools to use the <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#commandpatternjavascript" target="_blank">Command pattern</a> that will get triggered using native javascript events. Here is a quote about the Command pattern:</p>
			<p class="note">The command pattern aims to encapsulate method invocation, requests or operations into a single object and gives you the ability to both parameterize and pass method calls around that can be executed at your discretion. In addition, it enables you to decouple objects invoking the action from the objects which implement them, giving you a greater degree of overall flexibility in swapping out concrete 'classes'.</p>
			<p>The framework also provides an easy way to use prototypal inheritance. Two different versions can be used, a <span class="bold">javascript native version</span> with no dependency to other libraries and a <a href="http://mootools.net/" target="_blank">Mootools</a> version.</p>
			<p>soma.js is a "base" framework and does not provide tools for specific javascript tasks. External libraries can be used with the framework if you wish to, such as <a href="http://jquery.com/" target="_blank">jquery</a> or anything you like.</p>
			<p class="notesmall">soma.js is released under the <a href="http://www.mozilla.org/MPL/" target="_blank">Mozilla Public License</a>.</p>
		</section>

		<section id="download">
			<a name="download"></a>
			<h1>Downloads</h1>

			<ul>
				<li>
					<h2>Get soma.js</h2>
					<p>soma.js is available in two versions: a <span class="bold">javascript native version</span> with no dependency, and a Mootools version. Both versions are open source and available on Github.</p>
					<p>soma.js is a lightweight framework: 4.48 KB minified and compressed.</p>
					<ul>
						<li class="download"><a href="https://github.com/somajs/somajs/downloads" class="button icon tag" target="_blank">Download soma.js</a></li>
						<li>Download a zip containing framework, demos, docs, and so on (<a href="https://github.com/somajs/somajs/zipball/master">native version</a> - <a href="https://github.com/somajs/somajs/zipball/mootools">mootools version</a>)</li>
						<li>Framework repository (<a href="https://github.com/somajs/somajs/" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools" target="_blank">mootools version</a>)</li>
					</ul>
					<p>&nbsp;</p>
					<p class="note">The Mootools version requires the <a href="http://mootools.net/" target="_blank">Mootools framework</a>.</p>
				</li>
				<li>
					<h2>Quick Git clone</h2>
					<pre>$ git clone https://github.com/somajs/somajs.git</pre>
				</li>
				<li>
					<h2>Demos repository</h2>
					<ul>
						<li>Git demos repository (<a href="https://github.com/somajs/somajs/tree/master/demos" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>See the unit tests</h2>
					<ul>
						<li>Git tests repository (<a href="https://github.com/somajs/somajs/tree/master/tests" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/tests" target="_blank">mootools version</a>)</li>
						<li>Perform the tests (<a href="unittests/native/tests/" target="_blank">native version</a> - <a href="unittests/mootools/tests/" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>Get the CLI (command line interface)</h2>
					<p>soma.js projects can be generated from templates to get started.<br/>You must have <a href="http://www.java.com/" target="_blank">Java</a> installed on your operating system in order to use the CLI.</p>
					<p>Most of the time, java is already installed. Open a terminal and type <span class="codequote">java -version</span> to verify the Java version installed on your operating system (in a command prompt on Windows).</p>
					<ul>
						<li>Download the CLI (<a href="cli/native/somajs.jar">native version</a> - <a href="cli/mootools/somajs.jar">mootools version</a>)</li>
					</ul>
					<h3>Usage</h3>
					<p>Navigate to the folder where you downloaded the file somajs.jar, open a terminal and try the following commands.</p>
					<p>Print the help</p>
					<p class="codequote">java -jar somajs.jar -help</p>
					<p>Create an application (in the current folder of the CLI)</p>
					<p class="codequote">java -jar somajs.jar</p>
					<p>Specify an application name</p>
					<p class="codequote">java jar somajs.jar -n my_application</p>
					<p>Specify an javascript namespace</p>
					<p class="codequote">java jar somajs.jar -ns my_app</p>
					<p>Specify the output folder</p>
					<p class="codequote">java jar somajs.jar -o /Users/my_user/Desktop</p>
					<p>Specify a template (standard, standard-namespace, compact, compact-namespace)</p>
					<p class="codequote">java jar somajs.jar -t compact-namespace</p>
					<p>Specify a template url for custom templates (url or directory)</p>
					<p class="codequote">java jar somajs.jar -l http://domain.com/templates</p>
					<p class="codequote">java jar somajs.jar -l /Users/my_user/templates</p>
					<p class="note">Templates and source code are available in the repository.</p>
				</li>
			</ul>

		</section>

		<section id="tutorial">
			<a name="tutorial"></a>
			<h1>Tutorials</h1>

			<!--create application-->
			<section id="createapp" class="chapter">
				<a name="createapp"></a>
				<h2>Create a soma application</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>The first step to start building an application using soma is to create an object that will extend the framework.</p>
						<p>The framework object that can be extended is the <span class="codequote">soma.Application</span> object.</p>
						<p>See the <a href="js/app.js" target="_blank">framework instance</a> of this site.</p>
						<p>In this example, an object named <span class="codequote">SomaApplication</span> is created and the shortest way to do that is the following:</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a soma application
var SomaApplication = soma.Application.extend();
log("soma application created");
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>Once the framework has been extended to hold you own application, it can now be instantiated.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a soma application
var SomaApplication = soma.Application.extend();
// create an instance of the extended soma application
var app = new SomaApplication();
log(app);
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>However, the best way to create the "extended framework object" is to create a class that will be the <a href="http://en.wikipedia.org/wiki/Facade_pattern" target="_blank">Facade</a> of the application.</p>
						<p>The framework instance will be used as the starting point of the application. It is a good practice to create the major application elements in the framework, so the framework instance can show what has been created and what it is possible to do with it.</p>
						<p>For example, a framework instance could create a login object that will take care of the visual (view), a login object that will access to the server-side and hold the application state (model), and some commands to show the login window and log a user in.</p>
						<p>The framework will automatically call a series of methods that can be used to create the application elements. All the  methods are optional but are providing a structured way to create important elements.</p>
						<p>The first method called is the <span class="codequote">init</span> method:</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log('init application');
	}
});
// create an instance of the extended soma application
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>The last method called is the <span class="codequote">start</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log('init application');
	},
	start: function() {
		// triggered by the framework, can be used as the starting point of the application
		log('start application');
	}
});
// create an instance of the extended soma application
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>Here is the list of the methods called by the framework, in order of execution:
						<ul>
							<li>1. <span class="codequote">init</span></li>
							<li>2. <span class="codequote">registerModels</span></li>
							<li>3. <span class="codequote">registerViews</span></li>
							<li>4. <span class="codequote">registerCommands</span></li>
							<li>5. <span class="codequote">registerWires</span></li>
							<li>6. <span class="codequote">start</span></li>
						</ul>

						</p>

					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log('init application');
	},
	registerModels: function() {
		// triggered by the framework, can be used to register models
		log('register models');
	},
	registerViews: function() {
		// triggered by the framework, can be used to register views
		log('register views');
	},
	registerCommands: function() {
		// triggered by the framework, can be used to register commands
		log('register commands');
	},
	registerWires: function() {
		// triggered by the framework, can be used to register wires
		log('register wires');
	},
	start: function() {
		// triggered by the framework, can be used as the starting point of the application
		log('start application');
	}
});
// create an instance of the extended soma application
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 6</h3>
					<div class="content">
						<p>The framework instance can be retrieved from other framework elements, such as <span class="codequote">wires</span> and <span class="codequote">commands</span>.</p>
						<p>In the following example, the framework instance creates another framework element (a <span class="codequote">wire</span>) and access to the framework instance using the <span class="codequote">instance</span> member.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// create another framework element, a wire in this example
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered once the wire is added to the framework
		// access to the framework instance using the instance member
		log("framework instance: " + this.instance);
	}
});

// extend a soma application
var SomaApplication = soma.Application.extend({
	registerWires: function() {
		// add a framework element to the framework instance
		// a wire in this example
		this.addWire("wire", new WireExample());
	},
});
// create an instance of the extended soma application
var app = new SomaApplication();
</textarea>
					</div>
				</section>

			</section>

			<section id="createwire" class="chapter">
				<a name="createwire"></a>
				<h2>Create a wire</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>One of the most important framework elements are the <span class="codequote">wires</span>.</p>
						<p>The wires are the objects that hold the logic of the application. They are the glue between other framework elements such as models, views and other wires. Most of the time, a wire will have a specific role and responsibility in your application. A wire is a central point that can creates other wires, commands, models and views.</p>
						<p>You can create as many wires as you need, they are the "free" elements in the framework.</p>
						<p>A wire is also the framework element that has an easy access to everything else, such as other wires, models, views, commands, framework instance, and so on. Wires can be flexible or rigid depending of the needs of your application.</p>
						<p>The name of a wire is necessary to register it to the framework.</p>
						<p>A wire is a good place to control the flow of the application. Monitoring what is happening can be done listening to events and commands. They can be intercepted to interrupt their action if necessary. A wire can be used as a mediator and manage a single view (one to one relation), or can be responsible for anything.</p>
						<p>The wire object can be created extending the framework wire object <span class="codequote">soma.Wire</span>.</p>
						<p>Two methods can be overridden, the <span class="codequote">init</span> method that will be called once a wire has been added to the framework and the <span class="codequote">dispose</span> method that will be called once a wire has been removed from the framework.</p>
						<p>The <span class="codequote">init</span> method can be used as a starting point to create other framework elements, listen to events and commands while the dispose method is used to destroy what has been created or what it is responsible for.</p>
						<p>See the <a href="js/app/wires.js" target="_blank">wires</a> of this site.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
	},
	dispose: function() {
		// triggered when the wire is removed from the framework
	}
});

// create an instance of the extended wire
var wire = new WireExample();
log(wire);
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>A wire can be registered to the framework in three places:
							<ul>
								<li>1. in the framework instance</li>
								<li>2. in another wire</li>
								<li>3. in a command</li>
							</ul>
						</p>
						<p>In either place, a wire can be registered using the <span class="codequote">addWire</span> method.</p>
						<p>Here is an example to add a wire using the framework instance directly.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
		log("init wire");
	}
});
WireExample.NAME = "WireExample";

// create a framework instance
var SomaApplication = soma.Application.extend();
var app = new SomaApplication();

// add a wire to the framework
app.addWire(WireExample.NAME, new WireExample());
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>In the following example, the wire is added to the framework from the framework instance itself.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
		log("init wire");
	}
});
WireExample.NAME = "WireExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerWires: function() {
		// add a wire to the framework
		this.addWire(WireExample.NAME, new WireExample());
	}
});
// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>The wire instances registered to the framework can easily be retrieved in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a wire can be retrieved using the <span class="codequote">getWire</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
	},
});
WireExample.NAME = "WireExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerWires: function() {
		// add a wire to the framework
		this.addWire(WireExample.NAME, new WireExample());
		// retrieve a wire from the framework
		var retrievedWire = this.getWire(WireExample.NAME);
		log("retrieved wire: " + retrievedWire);
	}
});
// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>The wire instances registered to the framework can easily be removed in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a wire can be removed using the <span class="codequote">removeWire</span> method.</p>
					</div>
					<p>The <span class="codequote">dispose</span> method of the removed wires will be automatically called by the framework. The <span class="codequote">dispose</span> method is a good place to destroy what the wire has created.</p>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
		log("init wire");
	},
	dispose: function() {
		// triggered when the wire is removed from the framework
		log("dispose wire");
	}
});
WireExample.NAME = "WireExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerWires: function() {
		// add a wire to the framework
		this.addWire(WireExample.NAME, new WireExample());
		// check if the framework has a wire
		if (this.hasWire(WireExample.NAME)) {
			// remove a wire
			this.removeWire(WireExample.NAME);
		}
	}
});
// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 6</h3>
					<div class="content">
						<p>A wire has access to all the other framework elements.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var WireExample = soma.Wire.extend({
	init: function() {

	// models
	// this.addModel("model", ModelExample);
	// this.removeModel("model", ModelExample);
	// this.hasModel("model");
	// this.getModel("model");

	// wires
	// this.addWire("wire", WireExample);
	// this.removeWire("wire", WireExample);
	// this.hasWire("wire");
	// this.getWire("wire");

	// views
	// this.addView("view", ViewExample);
	// this.removeView("view", ViewExample);
	// this.hasView("view");
	// this.getView("view");

	// commands
	// this.addCommand("eventType", CommandExample);
	// this.removeCommand("eventType", CommandExample);
	// this.hasCommand("eventType", CommandExample);
	// this.dispatchEvent(new EventExample(EventExample.DO_SOMETHING));
	// this.addEventListener(EventExample.DO_SOMETHING, handler);
	// this.removeEventListener(EventExample.DO_SOMETHING, handler);

	},
});

</textarea>
					</div>
				</section>

			</section>

			<section id="createmodel" class="chapter">
				<a name="createmodel"></a>
				<h2>Create a model</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>The models are objects used to manage you application <a href="http://en.wikipedia.org/wiki/Data_model" target="_blank">data model</a>.</p>
						<p>The data can be XML, JSON, local data, data retrieved from a server, arrays or anything. Ideally, the data should be set to the <span class="codequote">data</span> property of the model instance, but you are free to create specific getters and variables.</p>
						<p>You can create as many models as you need. Your model object can extend the framework object	<span class="codequote">soma.Model</span>.</p>
						<p>Two methods can be overridden, the <span class="codequote">init</span> method that will be called once a model has been added to the framework and the <span class="codequote">dispose</span> method that will be called once a model has been removed from the framework.</p>
						<p>It is important that your model has no reference to the framework so it stays decoupled from the rest of the application. Your application will be built in an efficient loose-coupling way making it easily maintainable.</p>
						<p>See the <a href="js/app/models.js" target="_blank">models</a> of this site.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Model
var ModelExample = soma.Model.extend({
	init: function() {
		// triggered when the model is added to the framework
	},
	dispose: function() {
		// triggered when the model is removed from the framework
	}
});

// create an instance of the extended model
var model = new ModelExample();
log(model);
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>A model can be registered to the framework in three places:
							<ul>
								<li>1. in the framework instance</li>
								<li>2. in a wire</li>
								<li>3. in a command</li>
							</ul>
						</p>
						<p>In either place, a model can be registered using the <span class="codequote">addModel</span> method.</p>
						<p>Here is an example to add a model using the framework instance directly.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Model
var ModelExample = soma.Model.extend({
	init: function() {
		// triggered when the model is added to the framework
		log("init model");
	}
});
ModelExample.NAME = "ModelExample";

// create a framework instance
var SomaApplication = soma.Application.extend();
var app = new SomaApplication();

// add a model to the framework
app.addModel(ModelExample.NAME, new ModelExample());
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>In the following example, the model is added to the framework from the framework instance itself.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Model
var ModelExample = soma.Model.extend({
	init: function() {
		// triggered when the model is added to the framework
		log("init model");
	}
});
ModelExample.NAME = "ModelExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerModels: function() {
		// addd a model to the framework
		this.addModel(ModelExample.NAME, new ModelExample());
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>The model instances registered to the framework can easily be retrieved in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a model can be retrieved using the <span class="codequote">getModel</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Model
var ModelExample = soma.Model.extend({
	init: function() {
		// triggered when the model is added to the framework
		log("init model");
	},
});
ModelExample.NAME = "ModelExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerModels: function() {
		// add a model to the framework
		this.addModel(ModelExample.NAME, new ModelExample());
		// get a model from the framework
		var retrievedModel = this.getModel(ModelExample.NAME);
		log("retrieved model: " + retrievedModel);
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>The model instances registered to the framework can easily be removed in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a model can be removed using the <span class="codequote">removeWire</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a Model
var ModelExample = soma.Model.extend({
	init: function() {
		// triggered when the model is added to the framework
		log("init model");
	},
	dispose: function() {
		// triggered when the model is removed from the framework
		log("dispose model");
	}
});
ModelExample.NAME = "ModelExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerModels: function() {
		// add a model to the framework
		this.addModel(ModelExample.NAME, new ModelExample());
		// check if the framework has a model
		if (this.hasModel(ModelExample.NAME)) {
			// remove a model from the framework
			this.removeModel(ModelExample.NAME);
		}
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 6</h3>
					<div class="content">
						<p>A model instance does not have a direct access to the framework instance, or to other methods that can be found in wires and commands. However, a model instance can listen to events and commands and also dispatch events and commands to the framework.</p>
						<p>A model instance makes use of handy shortcuts to provide the same API as native built-in events: addEventListener, dispatchEvent, and so on.</p>
						<p>A dispatcher (<span class="codequote">soma.EventDispatcher</span>) can be registered to a model instance (<span class="codequote">dispatcher</span> property), the default dispatcher is the framework instance itself, but it is not a good practice to access it as a framework instance, this would tied the model to the application. It is a better practice to dispatch some events to tell the application that this model has done its job, that the data is ready or has changed, and that this event/command can be used everywhere in the application.</p>
						<p>The following example demonstrates how a command could be used to dispatch a notification to the framework.</p>
						<p>A command could be used to update several wires or views. Wires could also listen directly to the event without using a commands.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var ModelExample = soma.Model.extend({
	init: function() {

		// commands
		// this.dispatchEvent(new EventExample(EventExample.DO_SOMETHING));
		// this.addEventListener(EventExample.DO_SOMETHING, handler);
		// this.removeEventListener(EventExample.DO_SOMETHING, handler);

        log("init model");

		// assign some data to the data property
		this.data = [1, 2, 3];
		// notify the framework that the data has changed
		this.dispatchEvent(new soma.Event("dataChange"));

	},
});
ModelExample.NAME = "ModelExample";

// create a framework instance
var SomaApp = new soma.Application.extend();
var app = new SomaApp();

// add the model the framework
app.addModel(ModelExample.NAME, new ModelExample());

</textarea>
					</div>
				</section>
			</section>

			<section id="createview" class="chapter">
				<a name="createview"></a>
				<h2>Create a view</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>The view are classes that will display your application graphic elements such as buttons, animations, user interface, and so on. Your views should be completely free of framework code. They must be written in a efficient decoupled way so your views can easily be changed and re-used.</p>
						<p>Ideally, the logic of the view should be written in other classes (such as wires), so the view stays as simple as possible. But that is a choice and not required at all.</p>
						<p>You can create as many views as you need. Your view object can (optionally) extend the framework object soma.View, a simple wrapper that provides some shortcuts to dispatch events.</p>
						<p>Two methods can be overridden, the <span class="codequote">init</span> method that will be called once a model has been added to the framework and the <span class="codequote">dispose</span> method that will be called once a model has been removed from the framework.</p>
						<p>See the <a href="js/app/views.js" target="_blank">views</a> of this site.</p>
						<p class="note">If the application needs to target IE7 or IE8, the view object must extend the <span class="codequote">soma.View</span> wrapper. The wrapper is fixing several IE events implementation problems and makes possible to easily dispatched custom events using a common and native event interface (<span class="codequote">dispatchEvent</span>, <span class="codequote">addEventListener</span>, <span class="codequote">removeEventListener</span>).</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a view
var ViewExample = soma.View.extend({
	init: function() {
		// triggered when the view is added to the framework
	},
	dispose: function() {
		// triggered when the view is removed from the framework
	}
});

// create a view instance
var view = new ViewExample();
log(view);
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>In the following example, the view is created as a simple javascript object, without the wrapper <span class="codequote">soma.View</span>.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// create a view object
var ViewExample = function(){};

// add method to the view prototype
ViewExample.prototype = {
	init: function() {
		// triggered when the view is added to the framework
	},
	dispose: function() {
		// triggered when the view is removed from the framework
	}
};

// create a view instance
var view = new ViewExample();
log(view);
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>A view can be registered to the framework in three places:
							<ul>
								<li>1. in the framework instance</li>
								<li>2. in a wire</li>
								<li>3. in a command</li>
							</ul>
						</p>
						<p>In either place, a view can be registered using the <span class="codequote">addView</span> method.</p>
						<p>Here is an example to add a view using the framework instance directly.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a view
var ViewExample = soma.View.extend({
	init: function() {
		// triggered when the view is added to the framework
		log("init view");
	}
});
ViewExample.NAME = "ViewExample";

// extend a framework application
var SomaApplication = soma.Application.extend();
var app = new SomaApplication();

// add a view to the framework
app.addView(ViewExample.NAME, new ViewExample());
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>In the following example, the view is added to the framework from the framework instance itself.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a view
var ViewExample = soma.View.extend({
	init: function() {
		// triggered when the view is added to the framework
		log("init view");
	}
});
ViewExample.NAME = "ViewExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerViews: function() {
		// add a view to the framework
		this.addView(ViewExample.NAME, new ViewExample());
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>The <span class="codequote">soma.View</span> wrapper provides some shortcuts. In the following example a DOM Element is sent in the constructor to act as a "base" and dynamic DOM Element in the view.</p>
						<p>The DOM Element can be retrieve using the <span class="codequote">domElement</span> member.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a view
var ViewExample = soma.View.extend({
	init: function() {
		// triggered when the view is added to the framework
		// and get the DOM Element
		log("dom element: " + this.domElement);
	}
});
ViewExample.NAME = "ViewExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerViews: function() {
		// add a view to the framework
		// send a DOM Element to the view
		this.addView(ViewExample.NAME, new ViewExample(document.body.firstChild));
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 6</h3>
					<div class="content">
						<p>The view instances registered to the framework can easily be retrieved in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a view can be retrieved using the <span class="codequote">getView</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a view
var ViewExample = soma.View.extend({
	init: function() {
		// triggered when the view is added to the framework
		log("init view");
	},
});
ViewExample.NAME = "ViewExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerViews: function() {
		// add a view to the framework
		this.addView(ViewExample.NAME, new ViewExample());
		// get a view from the framework
		var retrievedView = this.getView(ViewExample.NAME);
		log("retrieved view: " + retrievedView);
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 7</h3>
					<div class="content">
						<p>The view instances registered to the framework can easily be removed in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a view can be removed using the <span class="codequote">removeView</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a view
var ViewExample = soma.View.extend({
	init: function() {
		// triggered when the model is added to the framework
		log("init view");
	},
	dispose: function() {
		// triggered when the view is removed from the framework
		log("dispose view");
	}
});
ViewExample.NAME = "ViewExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerViews: function() {
		// add a view to the framework
		this.addView(ViewExample.NAME, new ViewExample());
		// check if the framework has a view
		if (this.hasView(ViewExample.NAME)) {
			// remove a view from the framework
			this.removeView(ViewExample.NAME);
		}
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 8</h3>
					<div class="content">
						<p>A view does not have (and should not have) access to any framework elements in order to be completely decoupled from the framework. This ensure that the application is maintainable and that the views are re-usable.</p>
						<p>A view can send notification to the framework using native event, and will get updated from the framework elements that are responsible of the view.</p>
						<p>Simple custom methods on the view can be used to update its content (the view API).</p>
						<p>The events (commands) can be dispatched from the <span class="codequote">soma.View</span> wrapper or from any DOM Element.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var ViewExample = soma.View.extend({
	init: function() {

		// commands
		// this.dispatchEvent(new EventExample(EventExample.DO_SOMETHING));
		// document.body.dispatchEvent(new EventExample(EventExample.DO_SOMETHING));

	},
});
</textarea>
					</div>
				</section>
			</section>

			<section id="createcommand" class="chapter">
				<h2>Create a command</h2>
				<a name="createcommand"></a>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>A <a href="http://en.wikipedia.org/wiki/Command_pattern" target="_blank">Command</a> is a design-pattern that is used to execute a portion of code at any time.</p>
						<p>The command is used to transport data from framework elements (wires, models and views) without the elements to know about each other. It is also the only way for a view to tell the other framework elements to do their tasks without calling them directly. Calling them directly from a view would be a very bad practice in order to keep the view without framework code. As dispatching an event to trigger a command is a native process, we ensure that the app is built in a loosely coupled way.</p>
						<p>The process of executing a command in the framework is:
							<ul>
								<li>1. Create a command object that contains an <span class="codequote">execute</span> method</li>
								<li>2. Register the command object to the framework, assigned to an event type</li>
								<li>3. Dispatch an event from the framework or the DOM to execute the command</li>
							</ul>
						</p>
						<p>The framework is responsible of instantiating the command object and call its execute method. The command are also called "short-living" object, they are not meant to remain. The command object will be instantiated by the framework every time a command is triggered and destroyed after its task is complete.</p>
						<p>The event used to triggered the command can be used to transport data (send parameters to the command). The event used will always be sent to the <span class="codequote">execute</span> method of the command.</p>
						<p>The framework contains a simple <span class="codequote">Command</span> object, a <span class="codequote">SequenceCommand</span> object to execute a series of commands one after the other and a <span class="codequote">ParallelCommand</span> object to execute a bunch of commands all at once.</p>
						<p>See the <a href="js/app/commands.js" target="_blank">commands</a> of this site.</p>
						<p>To create a command object, you can extend the framework object <span class="codequote">soma.Command</span>.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// create a framework instance
var SomaApplication = soma.Application.extend();
var app = new SomaApplication();

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
	}
});

// add a command to the framework
app.addCommand("eventType", CommandExample);
log("has command: " + app.hasCommand("eventType"));
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>A command can be registered to the framework in three places:
						<ul>
							<li>1. in the framework instance</li>
							<li>2. in a wire</li>
							<li>3. in another command</li>
						</ul>
						</p>
						<p>In either place, a command can be registered using the <span class="codequote">addCommand</span> method, the parameters will be a string (an event type), and the command object to instantiate..</p>
						<p>In the following example, the view is added to the framework from the framework instance itself.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
	}
});

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerCommands: function() {
		// add a command to the framework
		this.addCommand("eventType", CommandExample);
		log("has command: " + this.hasCommand("eventType"));
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>The commands registered to the framework can easily be removed (un-registered) in the same three places (wires, commands, and framework instance).</p>
						<p>In either place, a command can be removed using the <span class="codequote">removeCommand</span> method.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
	}
});

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerCommands: function() {
		// add a command to the framework
		this.addCommand("eventType", CommandExample);
		// check if the framework has a command
		if (this.hasCommand("eventType")) {
			// remove a command from the framework
			this.removeCommand("eventType");
			log("has command: " + this.hasCommand("eventType"));
		}
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>To trigger the execution of a command, an event must be dispatched.</p>
						<p>The framework provides an event wrapper (<span class="codequote">soma.Event</span>) to solve cross-browsing issues. The way a native event is created differs from Internet Explorer and other browsers.</p>
						<p>Creating an instance of the <span class="codequote">soma.Event</span> object does not create a framework object but instead returns the browser specific event. The <span class="codequote">soma.Event</span> wrapper can be used without the framework.</p>
						<p>In the following example, the command has been registered using the string "eventType", which will be used as the event type to trigger the command. For the sake of the example, the event type is not referenced in a constant variable but it is a good practice to do so as you will see in other examples.</p>
						<p>An event (of the type the command that has been registered with) is dispatched to trigger the execution of the command.</p>
						<p>Once an event has been dispatched, the framework will do the following:
							<ul>
								<li>1. "catch" the event</li>
								<li>2. dispatch a clone to give you a chance to control the flow</li>
								<li>3. create the command instance</li>
								<li>4. call its execute method</li>
							</ul>
						</p>
						<p>Some details to know about the <span class="codequote">soma.Event</span> wrapper:</p>
						<p class="note">Other cross-browsing issues are solved using the <span class="codequote">soma.Event</span> wrapper, such as the property <span class="codequote">defaultPrevented</span>. It is recommended to use <span class="codequote">event.isDefaultPrevented()</span> rather than the browser specific one to ensure the same response in all browsers.</p>
						<p class="note">A event property <span class="codequote">event.params</span> has been added to hold custom variables.</p>
						<p class="note">Any event dispatched with a <span class="codequote">bubbles</span> property set to false will be ignored by the frameworl, the <span class="codequote">soma.Event</span> wrapper has the <span class="codequote">bubbles</span> property set to true by default.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
		// events with a bubbles property set to false will be ignored by the framework
		// the soma.Event wrapper has its bubbles property set to true by default
		log("bubbles: " + event.bubbles);
		log("execute command: " + event.type);
	}
});

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerCommands: function() {
		// add a command to the framework
		this.addCommand("eventType", CommandExample);
	},
	start: function() {
		// dispatch an event that will execute a command
		this.dispatchEvent(new soma.Event("eventType"));
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>An event that will trigger a command can also be dispatched from any DOM Element that has been added the DOM.</p>
						<p>In other words, an event can be dispatched from a button element, a div element or anything else.</p>
						<p class="note">This capability will not work in Internet Explorer 7 and 8, as it is not possible to dispatch custom events without hacks. If the application must target these two browsers, it is necessary to use the <span class="codequote">soma.View</span> object to create your views. The <span class="codequote">soma.View</span> object provides shortcut to dispatch custom events and trigger commands that have the same signature than the native ECMA events provided in more recent browsers: <span class="codequote">addEventListener</span>, <span class="codequote">removeEventListener</span> and <span class="codequote">dispatchEvent</span>.</p>
						<p class="note">In short, the shortcuts of the <span class="codequote">soma.View</span>: <span class="codequote">addEventListener</span>, <span class="codequote">removeEventListener</span> and <span class="codequote">dispatchEvent</span>, can be used in any browsers but are required with Internet Explorer 7 and 8.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
		// events with a bubbles property set to false will be ignored by the framework
		// the soma.Event wrapper has its bubbles property set to true by default
		log("execute command: " + event.type);
	}
});

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerCommands: function() {
		// add a command to the framework
		this.addCommand("eventType", CommandExample);
	},
});

// create a framework instance
var app = new SomaApplication();

// an event that will execute a command can be dispatched from any DOM element
document.body.firstChild.dispatchEvent(new soma.Event("eventType"));
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 6</h3>
					<div class="content">
						<p>The <span class="codequote">soma.Event</span> wrapper can be used directly to create an event, but it can also be extended.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend an event
var EventExample = soma.Event.extend();
// create an event instance
var event = new EventExample("eventType");
log(event);
log("type: " + event.type);
log("bubbles: " + event.bubbles);
log("cancelable: " + event.cancelable);
log("default prevented: " + event.isDefaultPrevented());
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 7</h3>
					<div class="content">
						<p>Extend the <span class="codequote">soma.Event</span> wrapper is optional but is a good practice for two reasons:
						<ul>
							<li>1. The event object can show explicitly what parameters can be used</li>
							<li>2. Static variable can be added to hold the event types (<span class="codequote">EventExample.MY_EVENT</span> in this example)</li>
						</ul>
						</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend an event
var EventExample = soma.Event.extend({
	// custom properties added to the constructor
	constructor: function(type, customVar, anotherVar, bubbles, cancelable) {
		// must call the super object and return it
		// the customs properties are stored in a single object (event.params)
		return soma.Event.call(this, type, {customVar:customVar, anotherVar:anotherVar}, bubbles, cancelable);
	}
});
EventExample.MY_EVENT = "myEvent";

// create an event and send parameters
var event = new EventExample(EventExample.MY_EVENT, "my custom var", "and another var");

// event.params is an object containing the parameters send with the event
log("params: " + event.params);
log("customVar: " + event.params.customVar);
log("anotherVar: " + event.params.anotherVar);
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 8</h3>
					<div class="content">
						<p>In the following example, a custom event is dispatched, it executes a command and the command retrieves parameters.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend an event
var EventExample = soma.Event.extend({
	// custom property added to the constructor
	constructor: function(type, customVar, bubbles, cancelable) {
		// must call the super object and return it
		// the custom property is stored in a single object
		return soma.Event.call(this, type, {customVar:customVar}, bubbles, cancelable);
	}
});
EventExample.DO_SOMETHING = "EventExample.DO_SOMETHING";

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
		log("execute command: " + event.type);
		// retrieve the parameter send with the event
		log("param: " + event.params.customVar);
		// the event is used to transport values and send them to other framework elements
		// example with a wire:
		// this.getWire("wireName").updateSomething(event.params.customVar);
	}
});

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerCommands: function() {
		// add a command to the framework
		this.addCommand(EventExample.DO_SOMETHING, CommandExample);
	},
});
// create a framework application
var app = new SomaApplication();

// dispatch an event with a custom value that will execute a command
app.dispatchEvent(new EventExample(EventExample.DO_SOMETHING, "custom var content"));
</textarea>
					</div>
				</section>
			</section>

			<section id="appflow" class="chapter">
				<a name="appflow"></a>
				<h2>Application flow</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>In the following example, we are going to monitor what is happening in an application in a very simple way.</p>
						<p>An application is created, a command is registered to the framework using the event type <span class="codequote">EventExample.DO_SOMETHING</span> and an event is dispatched in the <span class="codequote">start</span> method to trigger this command.</p>
						<p>Independently, a wire is also created and it will add an event listener. Every time this event will be dispatched, the listener handler method in this wire will receive a notification before the command is executed.</p>
						<p>The event can also be caught by other frameworks elements (wires and models) if there are not registered as a command, the framework elements shares the same dispatcher. With that said, to monitor events dispatched from views, the events must be registered as commands in order for the framework to catch them.</p>
						<p>Adding listeners is a good way to link framework elements to each other without them to know about each other. For example, an event can be dispatched (and listened to) in many other wires and models to react on this single event, do their task and probably dispatch other events upon completion.</p>
						<p>Here are the steps in order of execution for the following example:
						<ul>
							<li>1. An application is instantiated</li>
							<li>2. A command is registered in the <span class="codequote">registerCommands</span> method</li>
							<li>3. A wire is registered in the <span class="codequote">registerWires</span> method</li>
							<li>4. The framework registers the wire and call the <span class="codequote">init</span> method of the wire</li>
							<li>5. The <span class="codequote">init</span> method of the wire add an event listener</li>
							<li>6. An event is dispatched in the <span class="codequote">start</span> method</li>
							<li>7. The framework catch the event and recognize it as a command</li>
							<li>8. The framework creates a clone of the event and dispatch it</li>
							<li>9. The wire event handler receive the event</li>
							<li>10. The framework instantiates the command object and call its execute method</li>
						</ul>
						</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend an event
var EventExample = soma.Event.extend();
EventExample.DO_SOMETHING = "EventExample.DO_SOMETHING"

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
		log("execute command: " + event.type);
	}
});

// extend a wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
		log("init wire");
		// add a listener to monitor a command (or an event)
		this.addEventListener(EventExample.DO_SOMETHING, this.eventHandler.bind(this), false);
	},
	eventHandler: function(event) {
		// triggered if a command is about to be executed
		// or if an event of the same type is dispatched through the framework
		log("monitor command: " + event.type);
	}
});
WireExample.NAME = "WireExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	init: function() {
		// triggered once the framework is ready
		log("init application");
	},
	registerCommands: function() {
		// add a command to the framework
		this.addCommand(EventExample.DO_SOMETHING, CommandExample);
	},
	registerWires: function() {
		// add a wire to the framework
		this.addWire(WireExample, new WireExample());
	},
	start: function() {
		// dispatch an event to execute a command
		this.dispatchEvent(new EventExample(EventExample.DO_SOMETHING));
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
				<h3>Step 2</h3>
				<div class="content">
					<p>This example is very similar to the previous one. An event is dispatched but this time the wire will interrupt the flow and stop the execution of the command.</p>
					<p>In order to interupt the flow of the application, the event dispatched must have his <span class="codequote">cancelable</span> property set to true. In the event handler of the wire, a simple call to the <span class="codequote">preventDefault</span> method will prevent the framework from executing the command related to the event.</p>
				</div>
				<div class="code">
<textarea class="code" name="code">
// edit me and run the code

// extend an event
var EventExample = soma.Event.extend({
	// custom property added to the constructor
	constructor: function(type, customVar, bubbles, cancelable) {
		// must call the super object and return it
		// the custom property is stored in a single object
		return soma.Event.call(this, type, {customVar:customVar}, bubbles, cancelable);
	}
});
EventExample.DO_SOMETHING = "EventExample.DO_SOMETHING";

// extend a command
var CommandExample = soma.Command.extend({
	execute: function(event) {
		// triggered when a command is executed
		log("execute command: " + event.type);
	}
});

// extend a wire
var WireExample = soma.Wire.extend({
	init: function() {
		// triggered when the wire is added to the framework
		log("init wire");
		// add a listener to monitor a command (or an event)
		this.addEventListener(EventExample.DO_SOMETHING, this.eventHandler.bind(this), false);
	},
	eventHandler: function(event) {
		log("monitor command: " + event.type);
		// interrupt the application flow if the event has its cancelable property set to true
		// the command related to the event will not be executed
		event.preventDefault();
		log("cancelable: " + event.cancelable);
		log("prevent defaulted: " + event.isDefaultPrevented());
	}
});
WireExample.NAME = "WireExample";

// extend a framework application
var SomaApplication = soma.Application.extend({
	registerCommands: function() {
		// add a command tot he framework
		this.addCommand(EventExample.DO_SOMETHING, CommandExample);
	},
	registerWires: function() {
		// add a wire to the framework
		this.addWire(WireExample, new WireExample());
	},
	start: function() {
		// dispatch an event to execute a command
		// keep the bubbles set to true so the framework will still consider the event
		// set the cancelable property to true so the command can be stopped before execution
		this.dispatchEvent(new EventExample(EventExample.DO_SOMETHING, null, true, true));
	}
});

// create a framework instance
var app = new SomaApplication();
</textarea>
					</div>
				</section>
			</section>

			<section id="helloworld" class="chapter exercise">
				<a name="helloworld"></a>
				<h2>Hello world application</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>We are going to create a simple Hello world application. This application will update a DOM Element from a model, using a command.</p>
						<p>The first step will be creating a Model that will hold the data:</p>
						<ul>
							<li>1. create an object that extends <span class="codequote">soma.Model</span> and name it: "HelloWorldModel"</li>
							<li>2. create an <span class="codequote">init</span> method on this object</li>
							<li>3. create a property (static) "NAME" on the model object and set its name to "HelloWorldModel"</li>
							<li>4. in the <span class="codequote">init</span> method, set the <span class="codequote">data</span> property a string "Hello world"</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>We are now going to create the view that will update a DOM Element with a new content.</p>
						<ul>
							<li>1. create an object that extends <span class="codequote">soma.View</span> and name it: "HelloWorldView"</li>
							<li>2. create an <span class="codequote">updateMessage</span> method on this object that receive a parameter named "value"</li>
							<li>3. create a property (static) "NAME" on the model object to hold its name</li>
							<li>4. add the following lines in the init method of the view:
								<ul>
									<li><span class="codequote">$(this.domElement).removeClass("hidden");</span></li>
									<li><span class="codequote">this.domElement.innerHTML = value + " on " + new Date();</span></li>
								</ul>
							</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
		$(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>We need to create an event, this event will use to trigger a command and update the view from the model.</p>
						<ul>
							<li>1. create an event object that extends <span class="codequote">soma.Event</span> and name it: "HelloWorldEvent"</li>
							<li>2. create a property (static) "SHOW_MESSAGE" on the event object and set it to "showMessage"</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>We can now create a command, this command will be registered and triggered when the related event will be dispatched.</p>
						<p>We could have created a wire responsible of getting the data from the model to update the view but for simplicity, the command will do this task.</p>
						<ul>
							<li>1. create an command object that extends <span class="codequote">soma.Command</span> and name it: "HelloWorldCommand"</li>
							<li>2. create an empty execute method in the command</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";

var HelloWorldCommand = soma.Command.extend({
    execute: function() {
        
    }
});
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>Inside the execute method of the command, we can write two steps. The first one is getting the data from the model, and the second one is sending this data to the view.</p>
						<ul>
							<li>1. get the model <span class="codequote">HelloWorldModel</span> using the model name <span class="codequote">HelloWorldModel.NAME</span></li>
							<li>2. get the model data (<span class="codequote">data</span> property)</li>
							<li>3. get the view <span class="codequote">HelloWorldView</span> using the view name <span class="codequote">HelloWorldView.NAME</span></li>
							<li>4. send the model data using the <span class="codequote">updateMessage</span> method of the view</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";

var HelloWorldCommand = soma.Command.extend({
    execute: function() {
		var message = this.getModel(HelloWorldModel.NAME).data;
        this.getView(HelloWorldView.NAME).updateMessage(message);
    }
});
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 6</h3>
					<div class="content">
						<p>All the framework elements are created, we can now created a framework instance and instantiate it.</p>
						<ul>
							<li>1. create a framework object that extend <span class="codequote">soma.Application</span> and call it "HelloWorldApplication"</li>
							<li>2. add a <span class="codequote">registerModels</span>, <span class="codequote">registerCommands</span>, <span class="codequote">registerViews</span> and <span class="codequote">start</span> method to the framework object</li>
							<li>3. instantiate the framework instance</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";

var HelloWorldCommand = soma.Command.extend({
    execute: function() {
		var message = this.getModel(HelloWorldModel.NAME).data;
        this.getView(HelloWorldView.NAME).updateMessage(message);
    }
});

var HelloWorldApplication = soma.Application.extend({
    registerModels: function() {

    },
    registerCommands: function() {

    },
    registerViews: function() {

    },
    start: function() {

    }
});
var app = new HelloWorldApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 7</h3>
					<div class="content">
						<p>Let's add the model and the register the command we previously created.</p>
						<ul>
							<li>1. in the <span class="codequote">registerModels</span> method, register a new instance of the model <span class="codequote">HelloWorldModel</span></li>
							<li>2. in the <span class="codequote">registerCommands</span> method, register the <span class="codequote">HelloWorldCommand</span> with the <span class="codequote">HelloWorldEvent.SHOW_MESSAGE</span> even type</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";

var HelloWorldCommand = soma.Command.extend({
    execute: function() {
		var message = this.getModel(HelloWorldModel.NAME).data;
        this.getView(HelloWorldView.NAME).updateMessage(message);
    }
});

var HelloWorldApplication = soma.Application.extend({
    registerModels: function() {
		this.addModel(HelloWorldModel.NAME, new HelloWorldModel());
    },
    registerCommands: function() {
		this.addCommand(HelloWorldEvent.SHOW_MESSAGE, HelloWorldCommand);
    },
    registerViews: function() {

    },
    start: function() {

    }
});
var app = new HelloWorldApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 8</h3>
					<div class="content">
						<p>We can now register the view to the framework. We will pass the reference of a DOM Element to the constructor.</p>
						<p>For the purpose of this demo, we will use a specific DOM Element: the log element that will appear right below the current code editor.</p>
						<ul>
							<li>1. in the <span class="codequote">registerView</span> method, get the DOM Element that will receive the hello world message:
								<ul>
									<li class="codequote">var element = $("#log")[0];</li>
								</ul>
							</li>
							<li>2. in the <span class="codequote">registerView</span> method, register a new <span class="codequote">HelloWorldView</span> to the framework and send the DOM Element to the constructor</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";

var HelloWorldCommand = soma.Command.extend({
    execute: function() {
		var message = this.getModel(HelloWorldModel.NAME).data;
        this.getView(HelloWorldView.NAME).updateMessage(message);
    }
});

var HelloWorldApplication = soma.Application.extend({
    registerModels: function() {
		this.addModel(HelloWorldModel.NAME, new HelloWorldModel());
    },
    registerCommands: function() {
		this.addCommand(HelloWorldEvent.SHOW_MESSAGE, HelloWorldCommand);
    },
    registerViews: function() {
		var element = $("#log")[0];
	    this.addView(HelloWorldView.NAME, new HelloWorldView(element));
    },
    start: function() {

    }
});
var app = new HelloWorldApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 8</h3>
					<div class="content">
						<p>The last step is dispatching the event that will show the message (scroll down the page to see the DOM Element updated at the bottom).</p>
						<ul>
							<li>1. in the <span class="codequote">start</span> method, dispatch a new event <span class="codequote">HelloWorldEvent</span> or type <span class="codequote">HelloWorldEvent.SHOW_MESSAGE</span></li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var HelloWorldModel = soma.Model.extend({
    init: function() {
        this.data = "Hello World";
    }
});
HelloWorldModel.NAME = "HelloWorldModel";

var HelloWorldView = soma.View.extend({
    updateMessage: function(value) {
        $(this.domElement).removeClass("hidden");
        this.domElement.innerHTML = value + " on " + new Date();
    }
});
HelloWorldView.NAME = "HelloWorldView";

var HelloWorldEvent = soma.Event.extend();
HelloWorldEvent.SHOW_MESSAGE = "showMessage";

var HelloWorldCommand = soma.Command.extend({
    execute: function() {
		var message = this.getModel(HelloWorldModel.NAME).data;
        this.getView(HelloWorldView.NAME).updateMessage(message);
    }
});

var HelloWorldApplication = soma.Application.extend({
    registerModels: function() {
		this.addModel(HelloWorldModel.NAME, new HelloWorldModel());
    },
    registerCommands: function() {
		this.addCommand(HelloWorldEvent.SHOW_MESSAGE, HelloWorldCommand);
    },
    registerViews: function() {
		var element = $("#log")[0];
	    this.addView(HelloWorldView.NAME, new HelloWorldView(element));
    },
    start: function() {
		this.dispatchEvent(new HelloWorldEvent(HelloWorldEvent.SHOW_MESSAGE));
    }
});
var app = new HelloWorldApplication();
</textarea>
					</div>
				</section>
				<div id="helloworld-output"></div>
			</section>

			<!--create plugin -->
			<section id="createplugin" class="chapter">
				<a name="createplugin"></a>
				<h2>Create a soma plugin</h2>
				<!--step-->
				<section class="step">
					<h3>Step 1</h3>
					<div class="content">
						<p>Creating a soma plugin is very easy. You will need to create a function and send it to a <span class="codequote">createPlugin</span> method.</p>
						<p>The framework will instantiate the plugin and send the framework instance to the constructor. From this point you should be able to do anything, such as creating wires, commands, events, and so on.</p>
						<p>The <span class="codequote">createPlugin</span> method is accessible from the framework instance, the wires and the commands.</p>
						<p>Let's have a look at a real example, the <a href="plugin/native/plugin/image-loader/demos/simple-image-loader/" target="_blank">image loader plugin</a>.</p>
						<p>This plugin is able to do different things:</p>
						<ul>
							<li>1. take a json file as a parameter to describe a list of images</li>
							<li>2. load the json file and notify the framework elements (framework instance, wires, models)</li>
							<li>3. load a list of images</li>
							<li>4. notify the framework elements every time an image is loaded</li>
							<li>5. notify the framework elements when all the images are loaded</li>
						</ul>
						<p>The usage is very simple, creation of the plugin:</p>
						<p class="codequote">var plugin = this.createPlugin(SomaImageLoader, "assets/config.json");</p>
						<p>Add a listener to be notified when the json config file is loaded:</p>
						<p class="codequote">this.addEventListener(SomaImageLoaderEvent.CONFIG_LOADED, this.configLoadedHandler.bind(this));</p>
						<p>Start the loading using a command the plugin has registered:</p>
						<p class="codequote">this.dispatchEvent(new SomaImageLoaderEvent(SomaImageLoaderEvent.START));</p>
						<p>Add some listeners to be notified when the images are loaded to display them:</p>
						<p class="codequote">
							this.addEventListener(SomaImageLoaderEvent.ITEM_COMPLETE, this.itemCompleteHandler.bind(this));<br/>
							this.addEventListener(SomaImageLoaderEvent.QUEUE_COMPLETE, this.completeHandler.bind(this));
						</p>
						<p>See the <a href="plugin/native/plugin/image-loader/src/soma-image-loader.js" target="_blank">image-loader plugin code</a>, the <a href="plugin/native/plugin/image-loader/demos/simple-image-loader/assets/config.json" target="_blank">config json file</a> and <a href="plugin/native/plugin/image-loader/demos/simple-image-loader/js/app.js" target="_blank">how it is used</a>.</p>
						<p>Now let's create some plugins, go to the next step.</p>
					</div>
					<!--<div class="code">-->
<!--<textarea class="code" name="code">-->
<!--// edit me and run the code-->

<!--// extend a soma application-->
<!--var SomaApplication = soma.Application.extend();-->
<!--log("soma application created");-->
<!--</textarea>-->
					<!--</div>-->
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 2</h3>
					<div class="content">
						<p>To create a plugin we just need to follow 2 steps:</p>
						<ul>
							<li>1. create a function that will receive a framework instance as a first parameter</li>
							<li>2. send the class to the <span class="codequote">createPlugin</span> method</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var AlertPlugin = function(instance) {
	this.instance = instance;
	log('plugin created and framework instance received: ' + this.instance);
	log('framework instanceof: ' + (this.instance instanceof soma.Application));
}

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		log("create plugin");
		var plugin = this.createPlugin(AlertPlugin);
		log("plugin instance: " + plugin);
		log("plugin instanceof: " + (plugin instanceof AlertPlugin));
	}
});

var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 3</h3>
					<div class="content">
						<p>This is the same example as the previous one but with a different syntax.</p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var AlertPlugin = soma.extend({
	constructor: function(instance) {
		this.instance = instance;
		log('plugin created and framework instance received: ' + this.instance);
		log('framework instanceof: ' + (this.instance instanceof soma.Application));
	}
});

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		log("create plugin");
		var plugin = this.createPlugin(AlertPlugin);
		log("plugin instance: " + plugin);
		log("plugin instanceof: " + (plugin instanceof AlertPlugin));
	}
});

var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 4</h3>
					<div class="content">
						<p>Parameters can also be sent to the constructor. In this example we will send 2 other parameters: the message to alert, and a boolean to also print it in the log. </p>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var AlertPlugin = soma.extend({
	constructor: function(instance, message, printInLog) {
		this.instance = instance;
		if (printInLog) log(message);
		alert(message);
	},
});

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		var plugin = this.createPlugin(AlertPlugin, "Hello from AlertPlugin", true);
	}
});

var app = new SomaApplication();
</textarea>
					</div>
				</section>
				<!--step-->
				<section class="step">
					<h3>Step 5</h3>
					<div class="content">
						<p>Instead of sending the alert directly from the constructor of the plugin. Let's delegate this job to a command.</p>
						<p>The advantage of creating a command is that a simple event can be dispatched from anywhere in the application without knowing about the plugin. It could be dispatched from the framework instance, from a wire, from a model, from a view, or even from a DOM element.</p>
						<p>Ideally you can package these three objects: <span class="codequote">AlertPlugin</span>, <span class="codequote">AlertCommand</span> and <span class="codequote">AlertEvent</span> in a single javascript file and the plugin is ready.</p>
						<p>The usage of this plugin is very simple and only two lines:</p>
						<ul>
							<li class="codequote">this.createPlugin(AlertPlugin);</li>
							<li class="codequote">this.dispatchEvent(new AlertEvent(AlertEvent.SEND, "Hello from a command", true));</li>
						</ul>
						<p>It is also a good practice to create a <span class="codequote">dispose</span> method to let a user destroy/remove the elements created in your plugin:</p>
						<ul>
							<li class="codequote">this.plugin.dispose();</li>
							<li class="codequote">this.plugin = null;</li>
						</ul>
					</div>
					<div class="code">
<textarea class="code" name="code">
// edit me and run the code

var AlertPlugin = soma.extend({
	constructor: function(instance) {
		this.instance = instance;
		this.instance.addCommand(AlertEvent.SEND, AlertCommand);
	},
	dispose: function() {
		this.instance.removeCommand(AlertEvent.SEND);
		this.instance = null;
	}
});

var AlertCommand = soma.Command.extend({
	execute: function(event) {
		if (event.params.printInLog) log(event.params.message);
		alert(event.params.message);
	}
});

var AlertEvent = soma.Event.extend({
	constructor: function(type, message, printInLog) {
		return soma.Event.call(this, type, {message:message, printInLog:printInLog});
	}
});
AlertEvent.SEND = "send";

// extend a soma application
var SomaApplication = soma.Application.extend({
	init: function() {
		this.createPlugin(AlertPlugin);
	},
	start: function() {
		this.dispatchEvent(new AlertEvent(AlertEvent.SEND, "Hello from a command", true));
	}
});

var app = new SomaApplication();
</textarea>
					</div>
				</section>
			</section>

		</section>

		<section id="demos">
			<a name="demos"></a>
			<h1>Demos</h1>
			<p>Each demo is available in two versions, a soma native version (no library required) and a mootools version.</p>
			<ul>
				<li>
					<h2>Hello World</h2>
					<p>Print a message in the DOM, from a model, using a command.</p>
					<ul>
						<li>demo (<a href="examples/native/demos/helloworld/" target="_blank">native version</a> - <a href="examples/mootools/demos/helloworld/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/demos/helloworld" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos/helloworld" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>Cafe Town Send</h2>
					<p>Application with a login to display a list of employees, add and remove employees.</p>
					<ul>
						<li>demo (<a href="examples/native/demos/cafetownsend/" target="_blank">native version</a> - <a href="examples/mootools/demos/cafetownsend/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/demos/cafetownsend" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos/cafetownsend" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>Twitter Search</h2>
					<p>Use keywords to make a search with the Twitter API and display the result.</p>
					<ul>
						<li>demo (<a href="examples/native/demos/twittersearch/" target="_blank">native version</a> - <a href="examples/mootools/demos/twittersearch/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/demos/twittersearch" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos/twittersearch" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>Soma Color</h2>
					<p>Color application that is using other soma.js capabilities, such as parallel commands and sequence commands.</p>
					<ul>
						<li>demo (<a href="examples/native/demos/somacolor/" target="_blank">native version</a> - <a href="examples/mootools/demos/somacolor/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/demos/somacolor" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos/somacolor" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>App Note</h2>
					<p>Mobile application to add and remove notes, using local storage.</p>
					<ul>
						<li>demo (<a href="examples/native/demos/appnote/" target="_blank">native version</a> - <a href="examples/mootools/demos/appnote/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/demos/appnote" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos/appnote" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
				<li>
					<h2>Knockout</h2>
					<p>Example of <a href="http://knockoutjs.com/" target="_blank">knockout.js</a> data-bindings into a soma.js application.</p>
					<ul>
						<li>demo (<a href="examples/native/demos/knockout/" target="_blank">native version</a> - <a href="examples/mootools/demos/knockout/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/demos/knockout" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/demos/knockout" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
			</ul>
		</section>

		<section id="plugins">
			<a name="plugins"></a>
			<h1>Plugins</h1>
			<ul>
				<li>
					<h2>Router (with <a href="http://davisjs.com/" target="_blank">Davis.js</a>)</h2>
					<p>Add HTML 5 history states to the URL with a hash routing fallback possible.</p>
					<ul>
						<li>demo (<a href="http://soundstep.com/somajs/router/native/" target="_blank">native version</a> - <a href="http://soundstep.com/somajs/router/mootools/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/plugins/router" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/plugins/router" target="_blank">mootools version</a>)</li>
					</ul>
					<p>Here is a quick overview, create routes and map events:</p>
					<p class="codeblock">var routes = {
	"get": {
		"/" : RouterEventTypes.ROOT,
		":nav" : RouterEventTypes.NAV,
		":nav/:subnav" : RouterEventTypes.SUBNAV
	}
};
					</p>
					<p>Create the plugin:</p>
					<p class="codeblock">this.createPlugin(soma.router.Router, routes);</p>
					<p>Add event listeners to handle the url changes and links:</p>
					<p class="codeblock">this.addEventListener(RouterEventTypes.ROOT, this.rootHandler);
this.addEventListener(RouterEventTypes.NAV, this.navHandler);
this.addEventListener(RouterEventTypes.SUBNAV, this.subnavHandler);
					</p>
				</li>
				<li>
					<h2>ImageLoader (with <a href="http://thinkpixellab.com/pxloader/" target="_blank">PxLoader</a>)</h2>
					<p>Load images from a json <a href="plugin/native/plugin/image-loader/demos/simple-image-loader/assets/config.json" target="_blank">config file</a>, with queue progress and complete events.</p>
					<ul>
						<li>demo (<a href="plugin/native/plugin/image-loader/demos/simple-image-loader/" target="_blank">native version</a> - <a href="plugin/mootools/plugin/image-loader/demos/simple-image-loader/" target="_blank">mootools version</a>)</li>
						<li>code (<a href="https://github.com/somajs/somajs/tree/master/plugins/image-loader" target="_blank">native version</a> - <a href="https://github.com/somajs/somajs/tree/mootools/plugins/image-loader" target="_blank">mootools version</a>)</li>
					</ul>
				</li>
			</ul>
		</section>

		<section id="docs">
			<a name="docs"></a>
			<h1>Documentation</h1>
			<div>
				<p>The documentation is available for each soma.js version and contains more code examples.</p>
				<ul>
					<li>See the documentation (<a href="docs/native/" target="_blank">native version</a> - <a href="docs/mootools/" target="_blank">mootools version</a>)</li>
				</ul>
			</div>
		</section>

		<section id="discussion">
			<a name="discussion"></a>
			<h1>Discussion</h1>
			<div>
				<p>Want to ask some questions, talk about soma.js or just say hi?</p>
				<ul>
					<li>Visit our <a href="https://groups.google.com/forum/#!forum/somajs" target="_blank">Google Group</a></li>
				</ul>
			</div>
		</section>

		<section id="browsers">
			<a name="browsers"></a>
			<h1>Browsers information</h1>
			<div class="space-around">
				<img src="images/browser_chrome.png" alt="chrome"/>
				<img src="images/browser_firefox.png" alt="firefox"/>
				<img src="images/browser_ie.png" alt="internet explorer"/>
				<img src="images/browser_opera.png" alt="opera"/>
				<img src="images/browser_safari.png" alt="safari"/>
			</div>
			<div>
				<h2>Chrome</h2>
				<p>Latest version supported.</p>
				<h2>Firefox</h2>
				<p>Version 3.6 until latest version.</p>
				<h2>Internet Explorer</h2>
				<p class="red">Version 6 not supported.</p>
				<p>Version 7 supported.</p>
				<p>Version 8 supported.</p>
				<p>Version 9 supported.</p>
				<p class="note">Note: IE7 and IE8 require to use the <span class="codequote">soma.View</span> wrapper to solve different event implementation.</p>
				<h2>Opera</h2>
				<p>Latest version supported.</p>
				<h2>Safari</h2>
				<p>Latest version supported.</p>
			</div>
		</section>

	</div>

	<footer></footer>

</div>

<a href="https://github.com/somajs/somajs" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>

<!--[if lt IE 9]>
<script src="js/libs/html5.js"></script>
<![endif]-->

<script type="text/javascript" src="codemirror/js/codemirror.js"></script>
<script type="text/javascript" src="codemirror/js/javascript.js"></script>
<script type="text/javascript" src="js/libs/modernizr.js"></script>
<script type="text/javascript" src="js/libs/jquery-1.7.min.js"></script>
<script type="text/javascript" src="js/libs/utils.js"></script>
<script type="text/javascript" src="examples/native/framework/src/soma.js"></script>

<script type="text/javascript" src="js/app/constants.js"></script>
<script type="text/javascript" src="js/app/commands.js"></script>
<script type="text/javascript" src="js/app/events.js"></script>
<script type="text/javascript" src="js/app/models.js"></script>
<script type="text/javascript" src="js/app/views.js"></script>
<script type="text/javascript" src="js/app/wires.js"></script>
<script type="text/javascript" src="js/app.js"></script>

<script type="text/javascript">
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
